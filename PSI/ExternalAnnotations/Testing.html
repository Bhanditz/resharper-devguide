<!DOCTYPE HTML>
<html lang="en-US" manifest="../../manifest.appcache">
    
    <head>
        
        <meta charset="UTF-8">
        <title>Testing | ReSharper DevGuide</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 0.7.1">
        <meta name="HandheldFriendly" content="true">
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    <meta name="author" content="citizenmatt">
    
    
    

        
    </head>
    <body>
        
        
<link rel="stylesheet" href="../../gitbook/style.css">

    
    <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-richquotes/plugin.css">
    

    
    <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-anchors/plugin.css">
    

    
    <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-multipart/multipart.css">
    


        
    <div class="book" data-github="citizenmatt/resharper-devguide" data-level="5.10.1" data-basepath="../.." data-revision="1411742136055">
    <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    
    <a href="https://github.com/citizenmatt/resharper-devguide" target="_blank" class="btn pull-left home-bookmark" aria-label="GitHub home"><i class="fa fa-bookmark-o"></i></a>
    
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="btn-group btn-block">
        <button id="reduce-font-size" class="btn btn-default">A</button>
        <button id="enlarge-font-size" class="btn btn-default">A</button>
    </div>

    <ul class="list-group font-family-list">
        <li class="list-group-item" data-font="0">Serif</li>
        <li class="list-group-item" data-font="1">Sans</li>
    </ul>

    <div class="btn-group btn-group-xs btn-block color-theme-list">
        <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
    </div>
</div>

    </span>

    <!-- Actions Right -->
    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-spinner fa-spin"></i>
        <a href="../../">ReSharper DevGuide</a>
    </h1>
</div>

    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control">
    </div>
    <ul class="summary">
        
        
        
        <li>
            <a href="https://github.com/citizenmatt" target="blank" class="author-link">About the author</a>
        </li>
        

        
        
        <li>
            <a href="https://github.com/citizenmatt/resharper-devguide/issues" target="blank" class="issues-link">Questions and Issues</a>
        </li>
        

        
        
        <li>
            <a href="https://github.com/citizenmatt/resharper-devguide/edit/master/PSI/ExternalAnnotations/Testing.md" target="blank" class="contribute-link">Edit and Contribute</a>
        </li>
        

	

        
        <li class="divider"></li>
        

        
    
        
        <li class="part" data-level="0" data-path="index.html">
            
                
                    <a href="../../index.html">
                        <i class="fa fa-check"></i>
                        
                         Introduction
                    </a>
                
            
            
        </li>
    
        
        <li class="part" data-level="1">
            
            <span> Part I - Extending the ReSharper Platform</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="1.1">
            
            <span><b>1.</b> Getting Started</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="1.1.1" data-path="Intro/Tools.html">
            
                
                    <a href="../../Intro/Tools.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                         Tools
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.1.2">
            
            <span><b>1.2.</b> Internal mode</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="1.2">
            
            <span><b>2.</b> Platform Versioning</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="1.3" data-path="Intro/WhatsNew.html">
            
                
                    <a href="../../Intro/WhatsNew.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                         What&apos;s New?
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.4">
            
            <span><b>4.</b> Declarative Extensions</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="1.4.1">
            
            <span><b>4.1.</b> Live Templates</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="1.4.2">
            
            <span><b>4.2.</b> Structural Search and Replace Patterns</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="1.4.3">
            
            <span><b>4.3.</b> External Annotations</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="1.4.3.1">
            
            <span><b>4.3.1.</b> Attribute Reference</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="1.4.3.2">
            
            <span><b>4.3.2.</b> Annotator Tool</span>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="1.5">
            
            <span><b>5.</b> Compiled Extensions (Plugins)</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="1.5.1">
            
            <span><b>5.1.</b> Key Topics</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="1.5.2" data-path="Plugins/SDK.html">
            
                
                    <a href="../../Plugins/SDK.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                         SDK Reference
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.5.3" data-path="Plugins/ProjectSetup.html">
            
                
                    <a href="../../Plugins/ProjectSetup.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.3.</b>
                        
                         Project Setup
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.5.4">
            
            <span><b>5.4.</b> Debugging</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="1.5.5" data-path="Plugins/Testing.html">
            
                
                    <a href="../../Plugins/Testing.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.5.</b>
                        
                         Plugin testing
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="1.5.5.1">
            
            <span><b>5.5.1.</b> Test Framework</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="1.5.5.2" data-path="Plugins/TemporarySettings.html">
            
                
                    <a href="../../Plugins/TemporarySettings.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.5.2.</b>
                        
                         Temporary Settings
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="1.5.6" data-path="Intro/KnownIssues.html">
            
                
                    <a href="../../Intro/KnownIssues.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.6.</b>
                        
                         Known Issues
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="1.6" data-path="Extensions/Packaging.html">
            
                
                    <a href="../../Extensions/Packaging.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                         Deployment
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.7">
            
            <span><b>7.</b> Hints and Tips</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="1.8">
            
            <span><b>8.</b> Best Practices</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="part" data-level="2">
            
            <span> Part II - Architectural Overview</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="2.1" data-path="Architecture/Overview.html">
            
                
                    <a href="../../Architecture/Overview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                         Overview
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.2">
            
            <span><b>2.</b> Platform</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="2.3">
            
            <span><b>3.</b> Project Model</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="2.4">
            
            <span><b>4.</b> PSI</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="2.5">
            
            <span><b>5.</b> Features</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="2.6">
            
            <span><b>6.</b> Products</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="2.6.1">
            
            <span><b>6.1.</b> Standalone</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="2.6.2">
            
            <span><b>6.2.</b> Deployment</span>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="part" data-level="3">
            
            <span> Part III - Platform</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="3.1">
            
            <span><b>1.</b> Logging</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.2">
            
            <span><b>2.</b> DataFlow</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.3" data-path="Platform/Lifetime.html">
            
                
                    <a href="../../Platform/Lifetime.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                         Lifetime
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="3.3.1" data-path="Platform/Lifetime/Usage.html">
            
                
                    <a href="../../Platform/Lifetime/Usage.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                         Usage
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.3.2" data-path="Platform/Lifetime/LifetimeDefinition.html">
            
                
                    <a href="../../Platform/Lifetime/LifetimeDefinition.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                         Lifetime Management
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.3.3" data-path="Platform/Lifetime/Advanced.html">
            
                
                    <a href="../../Platform/Lifetime/Advanced.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                         Advanced Lifetime Management
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.3.4" data-path="Platform/Lifetime/ComponentModel.html">
            
                
                    <a href="../../Platform/Lifetime/ComponentModel.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                         Component Lifetime
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.3.5" data-path="Platform/Lifetime/CaseStudy.html">
            
                
                    <a href="../../Platform/Lifetime/CaseStudy.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                         Case Study
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="3.4" data-path="Platform/ComponentModel.html">
            
                
                    <a href="../../Platform/ComponentModel.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                         Component Model
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="3.4.1" data-path="Platform/ComponentModel/ContainersPartsCatalogues.html">
            
                
                    <a href="../../Platform/ComponentModel/ContainersPartsCatalogues.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                         Containers, Parts and Catalogues
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.4.2" data-path="Platform/VisualStudio/ComponentModel.html">
            
                
                    <a href="../../Platform/VisualStudio/ComponentModel.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                         Visual Studio interfaces
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="3.5" data-path="Platform/Zones.html">
            
                
                    <a href="../../Platform/Zones.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                         Zones
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="3.5.1" data-path="Platform/Zones/Implementation.html">
            
                
                    <a href="../../Platform/Zones/Implementation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                         Implementation
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.5.2" data-path="Platform/Zones/Usage.html">
            
                
                    <a href="../../Platform/Zones/Usage.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                         Usage
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.5.3" data-path="Platform/Zones/FeaturesProducts.html">
            
                
                    <a href="../../Platform/Zones/FeaturesProducts.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.3.</b>
                        
                         Features and Products
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.5.4" data-path="Platform/Zones/Activation.html">
            
                
                    <a href="../../Platform/Zones/Activation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.4.</b>
                        
                         Activation
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.5.5" data-path="Platform/Zones/Licensing.html">
            
                
                    <a href="../../Platform/Zones/Licensing.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.5.</b>
                        
                         Licensing
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.5.6" data-path="Platform/Zones/Troubleshooting.html">
            
                
                    <a href="../../Platform/Zones/Troubleshooting.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.6.</b>
                        
                         Troubleshooting
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="3.6">
            
            <span><b>6.</b> DataContext</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.7" data-path="Platform/TextControl.html">
            
                
                    <a href="../../Platform/TextControl.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                         TextControl
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.8">
            
            <span><b>8.</b> Documents</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.9">
            
            <span><b>9.</b> Threading</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.10">
            
            <span><b>10.</b> Locks</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.11">
            
            <span><b>11.</b> Transactions</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.12">
            
            <span><b>12.</b> IL Metadata</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.13">
            
            <span><b>13.</b> Shell</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="3.13.1">
            
            <span><b>13.1.</b> Visual Studio integration</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="3.13.1.1" data-path="Platform/VisualStudio/CustomHives.html">
            
                
                    <a href="../../Platform/VisualStudio/CustomHives.html">
                        <i class="fa fa-check"></i>
                        
                            <b>13.1.1.</b>
                        
                         Experimental Instances
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="3.13.2">
            
            <span><b>13.2.</b> Command line</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.13.3" data-path="Platform/Shell/ToolWindows.html">
            
                
                    <a href="../../Platform/Shell/ToolWindows.html">
                        <i class="fa fa-check"></i>
                        
                            <b>13.3.</b>
                        
                         Tool windows
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.13.4" data-path="Platform/Shell/Icons.html">
            
                
                    <a href="../../Platform/Shell/Icons.html">
                        <i class="fa fa-check"></i>
                        
                            <b>13.4.</b>
                        
                         Icons
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.13.5">
            
            <span><b>13.5.</b> Tooltips</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.13.6">
            
            <span><b>13.6.</b> TreeView</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.13.7">
            
            <span><b>13.7.</b> Progress reporting</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.13.8">
            
            <span><b>13.8.</b> Popup menus</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.13.9">
            
            <span><b>13.9.</b> Extensions</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.13.10">
            
            <span><b>13.10.</b> Theming</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="3.14" data-path="Platform/Settings.html">
            
                
                    <a href="../../Platform/Settings.html">
                        <i class="fa fa-check"></i>
                        
                            <b>14.</b>
                        
                         Settings
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="3.14.1">
            
            <span><b>14.1.</b> Reading and writing</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.14.2">
            
            <span><b>14.2.</b> Defaults</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.14.3">
            
            <span><b>14.3.</b> Layers</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.14.4">
            
            <span><b>14.4.</b> File format</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.14.5">
            
            <span><b>14.5.</b> Util</span>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="part" data-level="4">
            
            <span> Part IV - Project Model</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="4.1">
            
            <span><b>1.</b> Overview</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.2">
            
            <span><b>2.</b> Change Manager</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.3">
            
            <span><b>3.</b> MSBuild Integration</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.4">
            
            <span><b>4.</b> Project Files</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="part" data-level="5">
            
            <span> Part V - PSI</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.1">
            
            <span><b>1.</b> PSI Languages</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.1.1" data-path="PSI/PerLanguageComponents.html">
            
                
                    <a href="../../PSI/PerLanguageComponents.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                         Per-language Components
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5.2">
            
            <span><b>2.</b> Syntax trees</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.3" data-path="PSI/NavigatingSyntaxTrees.html">
            
                
                    <a href="../../PSI/NavigatingSyntaxTrees.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                         Navigating syntax trees
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.3.1">
            
            <span><b>3.1.</b> Helper methods</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.3.2" data-path="PSI/SyntaxTrees/StronglyTypedNavigation.html">
            
                
                    <a href="../../PSI/SyntaxTrees/StronglyTypedNavigation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                         Strongly typed navigation
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.3.3">
            
            <span><b>3.3.</b> Recursive navigation</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.3.4">
            
            <span><b>3.4.</b> Finding nodes</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5.4">
            
            <span><b>4.</b> Manipulating syntax trees</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.5">
            
            <span><b>5.</b> References</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.5.1">
            
            <span><b>5.1.</b> Resolving references</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.5.2" data-path="PSI/References/ReferenceProviders.html">
            
                
                    <a href="../../PSI/References/ReferenceProviders.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                         Reference providers
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.5.3" data-path="PSI/References/CodeCompletion.html">
            
                
                    <a href="../../PSI/References/CodeCompletion.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.3.</b>
                        
                         Code Completion
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.5.4" data-path="PSI/References/Substrings.html">
            
                
                    <a href="../../PSI/References/Substrings.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.4.</b>
                        
                         References within elements
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.5.5" data-path="PSI/References/IReferenceProvider.html">
            
                
                    <a href="../../PSI/References/IReferenceProvider.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.5.</b>
                        
                         Managing reference providers
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.5.6" data-path="PSI/References/PathReferences.html">
            
                
                    <a href="../../PSI/References/PathReferences.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.6.</b>
                        
                         Path references
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.5.7">
            
            <span><b>5.7.</b> Colour references</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5.6" data-path="PSI/Generating/Code.html">
            
                
                    <a href="../../PSI/Generating/Code.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                         Generating code
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.6.1" data-path="PSI/Generating/Comments.html">
            
                
                    <a href="../../PSI/Generating/Comments.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.</b>
                        
                         Generating comments
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5.7">
            
            <span><b>7.</b> Semantic models</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.7.1" data-path="PSI/TypeSystem.html">
            
                
                    <a href="../../PSI/TypeSystem.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.</b>
                        
                         Type system
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5.8">
            
            <span><b>8.</b> Control flow</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.9" data-path="PSI/Caches.html">
            
                
                    <a href="../../PSI/Caches.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                         Caches
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.10">
            
            <span><b>10.</b> External Annotations</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter active" data-level="5.10.1" data-path="PSI/ExternalAnnotations/Testing.html">
            
                
                    <a href="../../PSI/ExternalAnnotations/Testing.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.1.</b>
                        
                         Testing
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5.11">
            
            <span><b>11.</b> PSI Implementations Reference</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.11.1">
            
            <span><b>11.1.</b> C#</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.11.2">
            
            <span><b>11.2.</b> Visual Basic</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.11.3">
            
            <span><b>11.3.</b> JavaScript</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.11.4">
            
            <span><b>11.4.</b> TypeScript</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.11.5">
            
            <span><b>11.5.</b> JSON</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.11.6">
            
            <span><b>11.6.</b> HTML</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.11.7">
            
            <span><b>11.7.</b> CSS</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.11.8">
            
            <span><b>11.8.</b> Razor</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.11.9">
            
            <span><b>11.9.</b> ASP.net</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.11.10" data-path="PSI/Reference/Xml/Overview.html">
            
                
                    <a href="../../PSI/Reference/Xml/Overview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.10.</b>
                        
                         XML and DTD
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.11.10.1" data-path="PSI/Reference/Xml/Manipulation.html">
            
                
                    <a href="../../PSI/Reference/Xml/Manipulation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.10.1.</b>
                        
                         Manipulating the Tree
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.11.10.2" data-path="PSI/Reference/Xml/Navigators.html">
            
                
                    <a href="../../PSI/Reference/Xml/Navigators.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.10.2.</b>
                        
                         Navigators
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.11.10.3" data-path="PSI/Reference/Xml/ElementFactories.html">
            
                
                    <a href="../../PSI/Reference/Xml/ElementFactories.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.10.3.</b>
                        
                         Element Factories
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.11.10.4" data-path="PSI/Reference/Xml/Utils.html">
            
                
                    <a href="../../PSI/Reference/Xml/Utils.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.10.4.</b>
                        
                         Utils
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.11.10.5" data-path="PSI/Reference/Xml/TreeNodes.html">
            
                
                    <a href="../../PSI/Reference/Xml/TreeNodes.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.10.5.</b>
                        
                         Tree Nodes
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.11.10.6" data-path="PSI/Reference/Xml/TreeNodesDTD.html">
            
                
                    <a href="../../PSI/Reference/Xml/TreeNodesDTD.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.10.6.</b>
                        
                         Tree Nodes (DTD)
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5.11.11">
            
            <span><b>11.11.</b> Build scripts</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.11.12">
            
            <span><b>11.12.</b> XAML</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.11.13">
            
            <span><b>11.13.</b> XML Doc</span>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="part" data-level="6">
            
            <span> Part VI - Features</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.1">
            
            <span><b>1.</b> Analysis</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.1.1">
            
            <span><b>1.1.</b> Highlights</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.2">
            
            <span><b>1.2.</b> Custom highlights</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.3">
            
            <span><b>1.3.</b> Suppressing highlights</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.4" data-path="Features/Analysis/Daemons.html">
            
                
                    <a href="../../Features/Analysis/Daemons.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.4.</b>
                        
                         Daemons
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.5">
            
            <span><b>1.5.</b> Element problem analysers</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.6">
            
            <span><b>1.6.</b> Xml and Html analysers</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.7">
            
            <span><b>1.7.</b> Solution Wide Analysis</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.8">
            
            <span><b>1.8.</b> Error Stripe</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.9">
            
            <span><b>1.9.</b> Syntax Highlighting</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.10">
            
            <span><b>1.10.</b> Caches again</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.11">
            
            <span><b>1.11.</b> Value analysis</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.12">
            
            <span><b>1.12.</b> Call hierarchy</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.2" data-path="Features/Actions.html">
            
                
                    <a href="../../Features/Actions.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                         Actions
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.2.1">
            
            <span><b>2.1.</b> Menu items</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.2.2" data-path="Features/Actions/QuickFixes.html">
            
                
                    <a href="../../Features/Actions/QuickFixes.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                         Quick fixes
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.2.3">
            
            <span><b>2.3.</b> Context actions</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.2.4" data-path="Features/Actions/Bulk.html">
            
                
                    <a href="../../Features/Actions/Bulk.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                         Bulk actions
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.2.5">
            
            <span><b>2.5.</b> Overriding</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.2.6">
            
            <span><b>2.6.</b> Temporary editor actions</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.2.7">
            
            <span><b>2.7.</b> Action ID reference</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.3" data-path="Features/Completion.html">
            
                
                    <a href="../../Features/Completion.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                         Code Completion
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.3.1">
            
            <span><b>3.1.</b> Basic, smart and import</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.3.2">
            
            <span><b>3.2.</b> Dynamic completion</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.3.3">
            
            <span><b>3.3.</b> Double completion</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.3.4">
            
            <span><b>3.4.</b> Lookup items</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.4">
            
            <span><b>4.</b> Contextual highlighting</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.4.1">
            
            <span><b>4.1.</b> Brace matching</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.4.2">
            
            <span><b>4.2.</b> string.Format style highlighting</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.4.3">
            
            <span><b>4.3.</b> Find usages in file style highlighting</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.5">
            
            <span><b>5.</b> Popup docs</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.5.1" data-path="Features/QuickDoc/Overview.html">
            
                
                    <a href="../../Features/QuickDoc/Overview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                         Quick Doc
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.5.1.1" data-path="Features/QuickDoc/ImplementingProvider.html">
            
                
                    <a href="../../Features/QuickDoc/ImplementingProvider.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.1.</b>
                        
                         IQuickDocProvider
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.5.1.2" data-path="Features/QuickDoc/ImplementingPresenter.html">
            
                
                    <a href="../../Features/QuickDoc/ImplementingPresenter.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.2.</b>
                        
                         IQuickDocPresenter
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.5.1.3" data-path="Features/QuickDoc/HelperClasses.html">
            
                
                    <a href="../../Features/QuickDoc/HelperClasses.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.3.</b>
                        
                         Helper classes
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.5.1.4" data-path="Features/QuickDoc/ExistingProviders.html">
            
                
                    <a href="../../Features/QuickDoc/ExistingProviders.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.4.</b>
                        
                         Existing providers
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.5.1.5" data-path="Features/QuickDoc/Testing.html">
            
                
                    <a href="../../Features/QuickDoc/Testing.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.5.</b>
                        
                         Testing
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.5.2">
            
            <span><b>5.2.</b> Parameter Info</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.6" data-path="Features/Refactoring.html">
            
                
                    <a href="../../Features/Refactoring.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                         Refactoring
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.6.1">
            
            <span><b>6.1.</b> Workflow</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.6.2">
            
            <span><b>6.2.</b> Integrating</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.6.3">
            
            <span><b>6.3.</b> Renaming</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.6.4">
            
            <span><b>6.4.</b> Unused references</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.7" data-path="Features/GenerateMenu.html">
            
                
                    <a href="../../Features/GenerateMenu.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                         Generate Menu
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.8" data-path="Features/Navigation.html">
            
                
                    <a href="../../Features/Navigation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                         Navigation
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.8.1">
            
            <span><b>8.1.</b> Go to everything</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.8.2">
            
            <span><b>8.2.</b> Go to related</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.8.3">
            
            <span><b>8.3.</b> Go to next/prev</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.8.4">
            
            <span><b>8.4.</b> Contextual - find exits</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.8.5">
            
            <span><b>8.5.</b> Navigate from here</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.8.6">
            
            <span><b>8.6.</b> Occurrences</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.9" data-path="Features/OptionsPages.html">
            
                
                    <a href="../../Features/OptionsPages.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                         Options Pages
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.10">
            
            <span><b>10.</b> Tools</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.10.1" data-path="Features/Tools/CodeCleanup.html">
            
                
                    <a href="../../Features/Tools/CodeCleanup.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.1.</b>
                        
                         Code cleanup
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.10.2">
            
            <span><b>10.2.</b> Code structure</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.10.3">
            
            <span><b>10.3.</b> Todo items</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.10.4">
            
            <span><b>10.4.</b> Bookmarks</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.10.5">
            
            <span><b>10.5.</b> Assembly explorer</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.11">
            
            <span><b>11.</b> Naming</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.11.1">
            
            <span><b>11.1.</b> Suggestions</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.11.2">
            
            <span><b>11.2.</b> Policy</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.12">
            
            <span><b>12.</b> Editing</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.12.1">
            
            <span><b>12.1.</b> Formatting</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.12.2">
            
            <span><b>12.2.</b> Typing assist</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.12.3">
            
            <span><b>12.3.</b> Complete statement</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.12.4">
            
            <span><b>12.4.</b> Extend selection</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.12.5">
            
            <span><b>12.5.</b> Rearrange code</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.12.6">
            
            <span><b>12.6.</b> Comments</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.13">
            
            <span><b>13.</b> Structural Search and Replace</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.13.1">
            
            <span><b>13.1.</b> C# vs HTML and CSS</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.13.2">
            
            <span><b>13.2.</b> Programmatic usage</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.14" data-path="Features/LiveTemplates/Overview.html">
            
                
                    <a href="../../Features/LiveTemplates/Overview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>14.</b>
                        
                         Live Templates
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.14.1" data-path="Features/LiveTemplates/Macros.html">
            
                
                    <a href="../../Features/LiveTemplates/Macros.html">
                        <i class="fa fa-check"></i>
                        
                            <b>14.1.</b>
                        
                         Macros
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.14.2" data-path="Features/LiveTemplates/Scopes.html">
            
                
                    <a href="../../Features/LiveTemplates/Scopes.html">
                        <i class="fa fa-check"></i>
                        
                            <b>14.2.</b>
                        
                         Scopes
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.14.3">
            
            <span><b>14.3.</b> Categories</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.14.4">
            
            <span><b>14.4.</b> Quick lists</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.14.5">
            
            <span><b>14.5.</b> Hotspots</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.14.6">
            
            <span><b>14.6.</b> Programmatic usage</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.15" data-path="Features/UnitTest.html">
            
                
                    <a href="../../Features/UnitTest.html">
                        <i class="fa fa-check"></i>
                        
                            <b>15.</b>
                        
                         Unit Test
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.15.1">
            
            <span><b>15.1.</b> Test discovery</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.15.2">
            
            <span><b>15.2.</b> Test execution</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.15.3">
            
            <span><b>15.3.</b> Non-CLR tests</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.16">
            
            <span><b>16.</b> Diagramming</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.16.1">
            
            <span><b>16.1.</b> Architecture diagrams</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.17">
            
            <span><b>17.</b> External sources</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.17.1">
            
            <span><b>17.1.</b> PDB symbols</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.17.2">
            
            <span><b>17.2.</b> Decompiling</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.17.3">
            
            <span><b>17.3.</b> Source servers</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.18">
            
            <span><b>18.</b> Asp.net MVC</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.19">
            
            <span><b>19.</b> Internationalisation</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.20" data-path="Features/XmlLike.html">
            
                
                    <a href="../../Features/XmlLike.html">
                        <i class="fa fa-check"></i>
                        
                            <b>20.</b>
                        
                         Working with XML-like files
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="part" data-level="7">
            
            <span> Part VII - Products</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="7.1" data-path="Products/dotPeek.html">
            
                
                    <a href="../../Products/dotPeek.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                         dotPeek
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.2" data-path="Products/InspectCode.html">
            
                
                    <a href="../../Products/InspectCode.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                         InspectCode
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.3">
            
            <span><b>3.</b> Custom products</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="part" data-level="8">
            
            <span> Part VIII - Custom languages</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.1" data-path="CustomLanguages/Overview.html">
            
                
                    <a href="../../CustomLanguages/Overview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                         Overview
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.2">
            
            <span><b>2.</b> Registering a Custom Language</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.2.1">
            
            <span><b>2.1.</b> Project Model</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="8.2.2">
            
            <span><b>2.2.</b> PSI</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="8.3">
            
            <span><b>3.</b> Secondary PSI</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="8.4" data-path="CustomLanguages/InjectedPsi.html">
            
                
                    <a href="../../CustomLanguages/InjectedPsi.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                         Injected PSI
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5">
            
            <span><b>5.</b> Building the PSI tree</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.5.1">
            
            <span><b>5.1.</b> Lexing</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.2">
            
            <span><b>5.2.</b> Parsing</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.5.2.1">
            
            <span><b>5.2.1.</b> PsiGen and .psi Files</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.2.2">
            
            <span><b>5.2.2.</b> TreeBuilder</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="8.5.3">
            
            <span><b>5.3.</b> Extending Existing Languages</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.4">
            
            <span><b>5.4.</b> Incremental Parsing</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="8.6">
            
            <span><b>6.</b> Language Specific Features</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.6.1">
            
            <span><b>6.1.</b> Disabling Intellisense</span>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Generated using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 57.333333333333336%;min-width: 56%;"></div>
    </div>
    <div class="chapters">
    
        <a href="../../index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="../../Intro/Tools.html" title="Tools" class="chapter done " data-progress="1.1.1" style="left: 1.3333333333333333%;"></a>
    
        <a href="../../Intro/WhatsNew.html" title="What&apos;s New?" class="chapter done " data-progress="1.3" style="left: 2.6666666666666665%;"></a>
    
        <a href="../../Plugins/SDK.html" title="SDK Reference" class="chapter done " data-progress="1.5.2" style="left: 4%;"></a>
    
        <a href="../../Plugins/ProjectSetup.html" title="Project Setup" class="chapter done " data-progress="1.5.3" style="left: 5.333333333333333%;"></a>
    
        <a href="../../Plugins/Testing.html" title="Plugin testing" class="chapter done " data-progress="1.5.5" style="left: 6.666666666666667%;"></a>
    
        <a href="../../Plugins/TemporarySettings.html" title="Temporary Settings" class="chapter done " data-progress="1.5.5.2" style="left: 8%;"></a>
    
        <a href="../../Intro/KnownIssues.html" title="Known Issues" class="chapter done " data-progress="1.5.6" style="left: 9.333333333333334%;"></a>
    
        <a href="../../Extensions/Packaging.html" title="Deployment" class="chapter done " data-progress="1.6" style="left: 10.666666666666666%;"></a>
    
        <a href="../../Architecture/Overview.html" title="Overview" class="chapter done " data-progress="2.1" style="left: 12%;"></a>
    
        <a href="../../Platform/Lifetime.html" title="Lifetime" class="chapter done " data-progress="3.3" style="left: 13.333333333333334%;"></a>
    
        <a href="../../Platform/Lifetime/Usage.html" title="Usage" class="chapter done " data-progress="3.3.1" style="left: 14.666666666666666%;"></a>
    
        <a href="../../Platform/Lifetime/LifetimeDefinition.html" title="Lifetime Management" class="chapter done " data-progress="3.3.2" style="left: 16%;"></a>
    
        <a href="../../Platform/Lifetime/Advanced.html" title="Advanced Lifetime Management" class="chapter done " data-progress="3.3.3" style="left: 17.333333333333332%;"></a>
    
        <a href="../../Platform/Lifetime/ComponentModel.html" title="Component Lifetime" class="chapter done " data-progress="3.3.4" style="left: 18.666666666666668%;"></a>
    
        <a href="../../Platform/Lifetime/CaseStudy.html" title="Case Study" class="chapter done " data-progress="3.3.5" style="left: 20%;"></a>
    
        <a href="../../Platform/ComponentModel.html" title="Component Model" class="chapter done " data-progress="3.4" style="left: 21.333333333333332%;"></a>
    
        <a href="../../Platform/ComponentModel/ContainersPartsCatalogues.html" title="Containers, Parts and Catalogues" class="chapter done " data-progress="3.4.1" style="left: 22.666666666666668%;"></a>
    
        <a href="../../Platform/VisualStudio/ComponentModel.html" title="Visual Studio interfaces" class="chapter done " data-progress="3.4.2" style="left: 24%;"></a>
    
        <a href="../../Platform/Zones.html" title="Zones" class="chapter done " data-progress="3.5" style="left: 25.333333333333332%;"></a>
    
        <a href="../../Platform/Zones/Implementation.html" title="Implementation" class="chapter done " data-progress="3.5.1" style="left: 26.666666666666668%;"></a>
    
        <a href="../../Platform/Zones/Usage.html" title="Usage" class="chapter done " data-progress="3.5.2" style="left: 28%;"></a>
    
        <a href="../../Platform/Zones/FeaturesProducts.html" title="Features and Products" class="chapter done " data-progress="3.5.3" style="left: 29.333333333333332%;"></a>
    
        <a href="../../Platform/Zones/Activation.html" title="Activation" class="chapter done " data-progress="3.5.4" style="left: 30.666666666666668%;"></a>
    
        <a href="../../Platform/Zones/Licensing.html" title="Licensing" class="chapter done " data-progress="3.5.5" style="left: 32%;"></a>
    
        <a href="../../Platform/Zones/Troubleshooting.html" title="Troubleshooting" class="chapter done " data-progress="3.5.6" style="left: 33.333333333333336%;"></a>
    
        <a href="../../Platform/TextControl.html" title="TextControl" class="chapter done " data-progress="3.7" style="left: 34.666666666666664%;"></a>
    
        <a href="../../Platform/VisualStudio/CustomHives.html" title="Experimental Instances" class="chapter done " data-progress="3.13.1.1" style="left: 36%;"></a>
    
        <a href="../../Platform/Shell/ToolWindows.html" title="Tool windows" class="chapter done " data-progress="3.13.3" style="left: 37.333333333333336%;"></a>
    
        <a href="../../Platform/Shell/Icons.html" title="Icons" class="chapter done " data-progress="3.13.4" style="left: 38.666666666666664%;"></a>
    
        <a href="../../Platform/Settings.html" title="Settings" class="chapter done " data-progress="3.14" style="left: 40%;"></a>
    
        <a href="../../PSI/PerLanguageComponents.html" title="Per-language Components" class="chapter done " data-progress="5.1.1" style="left: 41.333333333333336%;"></a>
    
        <a href="../../PSI/NavigatingSyntaxTrees.html" title="Navigating syntax trees" class="chapter done " data-progress="5.3" style="left: 42.666666666666664%;"></a>
    
        <a href="../../PSI/SyntaxTrees/StronglyTypedNavigation.html" title="Strongly typed navigation" class="chapter done " data-progress="5.3.2" style="left: 44%;"></a>
    
        <a href="../../PSI/References/ReferenceProviders.html" title="Reference providers" class="chapter done " data-progress="5.5.2" style="left: 45.333333333333336%;"></a>
    
        <a href="../../PSI/References/CodeCompletion.html" title="Code Completion" class="chapter done " data-progress="5.5.3" style="left: 46.666666666666664%;"></a>
    
        <a href="../../PSI/References/Substrings.html" title="References within elements" class="chapter done " data-progress="5.5.4" style="left: 48%;"></a>
    
        <a href="../../PSI/References/IReferenceProvider.html" title="Managing reference providers" class="chapter done " data-progress="5.5.5" style="left: 49.333333333333336%;"></a>
    
        <a href="../../PSI/References/PathReferences.html" title="Path references" class="chapter done " data-progress="5.5.6" style="left: 50.666666666666664%;"></a>
    
        <a href="../../PSI/Generating/Code.html" title="Generating code" class="chapter done " data-progress="5.6" style="left: 52%;"></a>
    
        <a href="../../PSI/Generating/Comments.html" title="Generating comments" class="chapter done " data-progress="5.6.1" style="left: 53.333333333333336%;"></a>
    
        <a href="../../PSI/TypeSystem.html" title="Type system" class="chapter done " data-progress="5.7.1" style="left: 54.666666666666664%;"></a>
    
        <a href="../../PSI/Caches.html" title="Caches" class="chapter done " data-progress="5.9" style="left: 56%;"></a>
    
        <a href="../../PSI/ExternalAnnotations/Testing.html" title="Testing" class="chapter done " data-progress="5.10.1" style="left: 57.333333333333336%;"></a>
    
        <a href="../../PSI/Reference/Xml/Overview.html" title="XML and DTD" class="chapter  " data-progress="5.11.10" style="left: 58.666666666666664%;"></a>
    
        <a href="../../PSI/Reference/Xml/Manipulation.html" title="Manipulating the Tree" class="chapter  " data-progress="5.11.10.1" style="left: 60%;"></a>
    
        <a href="../../PSI/Reference/Xml/Navigators.html" title="Navigators" class="chapter  " data-progress="5.11.10.2" style="left: 61.333333333333336%;"></a>
    
        <a href="../../PSI/Reference/Xml/ElementFactories.html" title="Element Factories" class="chapter  " data-progress="5.11.10.3" style="left: 62.666666666666664%;"></a>
    
        <a href="../../PSI/Reference/Xml/Utils.html" title="Utils" class="chapter  " data-progress="5.11.10.4" style="left: 64%;"></a>
    
        <a href="../../PSI/Reference/Xml/TreeNodes.html" title="Tree Nodes" class="chapter  " data-progress="5.11.10.5" style="left: 65.33333333333333%;"></a>
    
        <a href="../../PSI/Reference/Xml/TreeNodesDTD.html" title="Tree Nodes (DTD)" class="chapter  " data-progress="5.11.10.6" style="left: 66.66666666666667%;"></a>
    
        <a href="../../Features/Analysis/Daemons.html" title="Daemons" class="chapter  " data-progress="6.1.4" style="left: 68%;"></a>
    
        <a href="../../Features/Actions.html" title="Actions" class="chapter  " data-progress="6.2" style="left: 69.33333333333333%;"></a>
    
        <a href="../../Features/Actions/QuickFixes.html" title="Quick fixes" class="chapter  " data-progress="6.2.2" style="left: 70.66666666666667%;"></a>
    
        <a href="../../Features/Actions/Bulk.html" title="Bulk actions" class="chapter  " data-progress="6.2.4" style="left: 72%;"></a>
    
        <a href="../../Features/Completion.html" title="Code Completion" class="chapter  " data-progress="6.3" style="left: 73.33333333333333%;"></a>
    
        <a href="../../Features/QuickDoc/Overview.html" title="Quick Doc" class="chapter  " data-progress="6.5.1" style="left: 74.66666666666667%;"></a>
    
        <a href="../../Features/QuickDoc/ImplementingProvider.html" title="IQuickDocProvider" class="chapter  " data-progress="6.5.1.1" style="left: 76%;"></a>
    
        <a href="../../Features/QuickDoc/ImplementingPresenter.html" title="IQuickDocPresenter" class="chapter  " data-progress="6.5.1.2" style="left: 77.33333333333333%;"></a>
    
        <a href="../../Features/QuickDoc/HelperClasses.html" title="Helper classes" class="chapter  " data-progress="6.5.1.3" style="left: 78.66666666666667%;"></a>
    
        <a href="../../Features/QuickDoc/ExistingProviders.html" title="Existing providers" class="chapter  " data-progress="6.5.1.4" style="left: 80%;"></a>
    
        <a href="../../Features/QuickDoc/Testing.html" title="Testing" class="chapter  " data-progress="6.5.1.5" style="left: 81.33333333333333%;"></a>
    
        <a href="../../Features/Refactoring.html" title="Refactoring" class="chapter  " data-progress="6.6" style="left: 82.66666666666667%;"></a>
    
        <a href="../../Features/GenerateMenu.html" title="Generate Menu" class="chapter  " data-progress="6.7" style="left: 84%;"></a>
    
        <a href="../../Features/Navigation.html" title="Navigation" class="chapter  " data-progress="6.8" style="left: 85.33333333333333%;"></a>
    
        <a href="../../Features/OptionsPages.html" title="Options Pages" class="chapter  " data-progress="6.9" style="left: 86.66666666666667%;"></a>
    
        <a href="../../Features/Tools/CodeCleanup.html" title="Code cleanup" class="chapter  " data-progress="6.10.1" style="left: 88%;"></a>
    
        <a href="../../Features/LiveTemplates/Overview.html" title="Live Templates" class="chapter  " data-progress="6.14" style="left: 89.33333333333333%;"></a>
    
        <a href="../../Features/LiveTemplates/Macros.html" title="Macros" class="chapter  " data-progress="6.14.1" style="left: 90.66666666666667%;"></a>
    
        <a href="../../Features/LiveTemplates/Scopes.html" title="Scopes" class="chapter  " data-progress="6.14.2" style="left: 92%;"></a>
    
        <a href="../../Features/UnitTest.html" title="Unit Test" class="chapter  " data-progress="6.15" style="left: 93.33333333333333%;"></a>
    
        <a href="../../Features/XmlLike.html" title="Working with XML-like files" class="chapter  " data-progress="6.20" style="left: 94.66666666666667%;"></a>
    
        <a href="../../Products/dotPeek.html" title="dotPeek" class="chapter  " data-progress="7.1" style="left: 96%;"></a>
    
        <a href="../../Products/InspectCode.html" title="InspectCode" class="chapter  " data-progress="7.2" style="left: 97.33333333333333%;"></a>
    
        <a href="../../CustomLanguages/Overview.html" title="Overview" class="chapter  " data-progress="8.1" style="left: 98.66666666666667%;"></a>
    
        <a href="../../CustomLanguages/InjectedPsi.html" title="Injected PSI" class="chapter  " data-progress="8.4" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_37">
                    
                        <h1 id="testing-external-annotations"><a name="testing-external-annotations" class="plugin-anchor" href="#testing-external-annotations"><span class="fa fa-link"></span></a>Testing External Annotations</h1>
<p>There are two approaches to testing External Annotations. The first is to use the <code>CodeAnnotationsCache</code> class to assert that annotations are applied to specific code elements in the compiled assemblies. The second is to assert the highlights and warnings that are affected by annotations. For example, an element marked with the <code>[NotNull]</code> attribute will cause ReSharper to highlight a null check as unnecessary.</p>
<p>Which method you choose is up to you. The first approach tests that the external annotations are correctly applied, while the second asserts the expected result of applying the annotations. ReSharper doesn&apos;t prescribe a specific approach; there are no base classes or helper methods specifically for testing external annotations. The first approach requires some helper methods, and an example base class is provided below, while the second approach is a normal highlighting test.</p>
<h2 id="loading-the-annotations"><a name="loading-the-annotations" class="plugin-anchor" href="#loading-the-annotations"><span class="fa fa-link"></span></a>Loading the annotations</h2>
<p>Before any tests can run, the annotations need to be loaded by the test environment. ReSharper doesn&apos;t do this by default, it only loads annotations that are installed with the product, or as extensions. Instead, they have to be loaded explicitly by the test assembly, by implementing <code>IExternalAnnotationsFileProvider</code> and marking the component with the <code>[ShellComponent]</code> attribute.</p>
<p>The following class will load all annotations stored in a specific folder, which, in this example will be <code>test\data\annotations</code>, but by replacing the implementation of <code>RelativeTestDataPath</code> you can change it to another location relative to <code>test\data</code>, even outside of the <code>test\data</code> folder structure. Or you can completely replace <code>BaseTestDataPath</code> to return any location you want.</p>
<p>This provider will load all XML files that are immediate children of the file location. These are expected to be named after the assembly, e.g. <code>myAssembly.dll</code> would need a <code>myAssembly.xml</code> file in the root location. It will also recursively look for any XML files in child directories. Either the directory should be named after the assembly, in which case all files in that directory apply to the assembly, or the file should be named after the assembly. This is the same folder structure and naming scheme used when annotations are distributed inside an extension package.</p>
<pre><code class="lang-cs">[ShellComponent]
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> TestExternalAnnotationsProvider : IExternalAnnotationsFileProvider
{
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> OneToSetMap&lt;<span class="hljs-keyword">string</span>, FileSystemPath&gt; annotations;
  <span class="hljs-keyword">private</span> FileSystemPath cachedBaseTestDataPath;

  <span class="hljs-keyword">public</span> <span class="hljs-title">TestExternalAnnotationsProvider</span>()
  {
    <span class="hljs-keyword">var</span> location = TestDataPath2;
    annotations = <span class="hljs-keyword">new</span> OneToSetMap&lt;<span class="hljs-keyword">string</span>, FileSystemPath&gt;(StringComparer.OrdinalIgnoreCase);

    <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> file <span class="hljs-keyword">in</span> location.GetChildFiles(<span class="hljs-string">&quot;*.xml&quot;</span>))
      annotations.Add(file.NameWithoutExtension, file);
    <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> directory <span class="hljs-keyword">in</span> location.GetChildDirectories())
    {
      <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> file <span class="hljs-keyword">in</span> directory.GetChildFiles(<span class="hljs-string">&quot;*.xml&quot;</span>, PathSearchFlags.RecurseIntoSubdirectories))
      {
        annotations.Add(file.NameWithoutExtension, file);
        annotations.Add(file.Directory.Name, file);
      }
    }
  }

  <span class="hljs-keyword">public</span> IEnumerable&lt;FileSystemPath&gt; <span class="hljs-title">GetAnnotationsFiles</span>(AssemblyNameInfo assemblyName = <span class="hljs-keyword">null</span>, FileSystemPath assemblyLocation = <span class="hljs-keyword">null</span>)
  {
    <span class="hljs-keyword">if</span> (assemblyName == <span class="hljs-keyword">null</span>)
      <span class="hljs-keyword">return</span> annotations.Values;
    <span class="hljs-keyword">return</span> annotations[assemblyName.Name];
  }

  <span class="hljs-keyword">private</span> FileSystemPath BaseTestDataPath
  {
    <span class="hljs-keyword">get</span>
    {
      <span class="hljs-keyword">if</span> (cachedBaseTestDataPath == <span class="hljs-keyword">null</span>)
        cachedBaseTestDataPath = TestUtil.GetTestDataPathBase(GetType().Assembly);
      <span class="hljs-keyword">return</span> cachedBaseTestDataPath;
    }
  }

  <span class="hljs-keyword">private</span> <span class="hljs-keyword">string</span> RelativeTestDataPath
  {
    <span class="hljs-comment">// This can be relative, e.g. @&quot;..\..\ExternalAnnotations&quot;</span>
    <span class="hljs-keyword">get</span> { <span class="hljs-keyword">return</span> <span class="hljs-string">@&quot;annotations&quot;</span>; }
  }

  <span class="hljs-keyword">private</span> FileSystemPath TestDataPath2
  {
    <span class="hljs-keyword">get</span> { <span class="hljs-keyword">return</span> BaseTestDataPath.Combine(RelativeTestDataPath); }
  }
}
</code></pre>
<h2 id="targeting-the-assembly"><a name="targeting-the-assembly" class="plugin-anchor" href="#targeting-the-assembly"><span class="fa fa-link"></span></a>Targeting the assembly</h2>
<p>External annotations don&apos;t target source files, but already existing, compiled assemblies. In order to test that annotations are correctly applied, the in-memory, temporary project created by the test environment needs to add references to the target assembly/assemblies.</p>
<p>This is easily done using the <code>[TestReferences]</code> attribute on the test class. The parameters to the attribute are the names of the assemblies to reference. The values can be a filename, or a relative or absolute file path. If the value is a filename or a relative file path, the actual path is resolved against the <code>TestDataPath2</code> property (which resolves to <code>test\data</code> plus the value of <code>RelativeTestDataPath</code>). If the value is an absolute file path, it is used as-is.</p>
<pre><code class="lang-cs">[TestReferences(<span class="hljs-string">&quot;myAssembly.dll&quot;</span>, <span class="hljs-string">&quot;mySupport.dll&quot;</span>)]
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> MyAssemblyAnnotationsTest : ExternalAnntotionsTestBase2
{
  <span class="hljs-comment">// ...</span>
}
</code></pre>
<p>The referenced assembly names can also contain environment variable names, which will be expanded before use. This can be very useful, as environment variables can be set programmatically by overriding the <code>SetUp</code> method. E.g.:</p>
<pre><code class="lang-cs">[TestReferences(<span class="hljs-string">@&quot;%MY_ASSEMBLY_PATH%\myAssembly.dll&quot;</span>)]
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> MyAssemblyAnnotationsTest : ExternalAnnotationsTestBase2
{
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SetUp</span>()
  {
    <span class="hljs-keyword">base</span>.SetUp();

    Environment.SetEnvironmentVariable(<span class="hljs-string">&quot;MY_ASSEMBLY_PATH&quot;</span>, BaseTestDataPath.Combine(<span class="hljs-string">&quot;lib&quot;</span>));
  }
}
</code></pre>
<p>If you need more control over the references you&apos;re adding, you can override the <code>BaseTestWithSingleProject.GetReferencedAssemblies</code> method.</p>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-4x fa-edit"></strong>
<p> Remember that external annotations can target multiple versions of an assembly by specifying the version in the assembly <code>name</code> attribute in the XML file. To test multiple versions, simply create multiple test classes, each referencing a different version of the target assembly. If the multiple versions share test cases, they can implemented in a base class and shared via inheritance.</p>
<p>If using base classes, the <code>TestReferencesAttribute.Inherits</code> property declares whether <code>TestReferences</code> attributes on the base class are used or not. By default, they aren&apos;t - the <code>TestReferences</code> attribute of declared classes override the base class.</p>
</blockquote>
<h2 id="testing-applied-annotations"><a name="testing-applied-annotations" class="plugin-anchor" href="#testing-applied-annotations"><span class="fa fa-link"></span></a>Testing applied annotations</h2>
<p>The following code snippet defines a class called <code>ExternalAnnotationsTestBase2</code> which provides a helper method to convert an XML Doc ID to an <code>IDeclaredElement</code>. It then gets an instance of <code>CodeAnnotationsCache</code> and both are passed to the assert method, which can use the cache to ask for the annotations applied to the given code element.</p>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-4x fa-edit"></strong>
<p> ReSharper already defines a class called <code>ExternalAnnotationsTestBase</code> that provides similar functionality used internally for testing external annotations. However, it is unsuitable to use as a base class for plugin tests, as it defines tests for the standard BCL annotations, which would also run for your plugin tests.</p>
</blockquote>
<p>The base class looks like this:</p>
<pre><code class="lang-cs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> ExternalAnnotationsTestBase2 : BaseTestWithSingleProject
{
  <span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> RelativeTestDataPath { <span class="hljs-keyword">get</span> { <span class="hljs-keyword">return</span> <span class="hljs-keyword">string</span>.Empty; } }

  <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">AssertHelper</span>(<span class="hljs-keyword">string</span> xmlDocId, Action&lt;CodeAnnotationsCache, IDeclaredElement&gt; assert)
  {
    <span class="hljs-comment">// We&apos;re not checking source files, but referenced assemblies</span>
    <span class="hljs-keyword">var</span> sourceFiles = EmptyList&lt;<span class="hljs-keyword">string</span>&gt;InstanceList;

    WithSingleProject(sourceFiles, (lifetime, solution, project) =&gt;
    {
      RunGuarded(() =&gt;
      {
        <span class="hljs-keyword">var</span> psiModule = solution.PsiModules().GetPrimaryPsiModule(project);
        <span class="hljs-keyword">var</span> psiServices = solution.GetPsiServices();

        <span class="hljs-comment">// Get the IDeclaredElement from the XML Doc ID</span>
        <span class="hljs-keyword">var</span> declaredElement = XMLDocUtil.ResolveId(psiServices, xmlDocId, psiModule, <span class="hljs-keyword">true</span>, project.GetResolveContext();
        Assert.NotNull(declaredElement, <span class="hljs-string">&quot;Declared element cannot be resolved from XMLDocID {0}&quot;</span>, xmlDocId);

        <span class="hljs-keyword">var</span> annotationsCache = psiServices.GetAnnotationsCache();

        assert(annotationsCache, declaredElement);
      });
    });
  }

  <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">AssertMeansImplicitUseAttribute</span>(<span class="hljs-keyword">string</span> xmlDocId)
  {
    AssertHelper(xmlDocId, (cache, element) =&gt;
    {
      <span class="hljs-keyword">var</span> attributesOwner = element <span class="hljs-keyword">as</span> IAttributesOwner;
      Assert.NotNull(attributesOwner, <span class="hljs-string">&quot;Declared element is not an IAttributesOwner {0}&quot;</span>, xmlDocId);

      <span class="hljs-keyword">var</span> attributeInstances = attributesOwner.GetAttributeInstances(<span class="hljs-keyword">false</span>);
      <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> attributeInstance <span class="hljs-keyword">in</span> attributeInstances)
      {
        ImplicitUseKindFlags kindFlags;
        ImplicitUseTargetFlags targetFlags;
        <span class="hljs-keyword">if</span> (cache.IsMeansImplicitUse(attributeInstance, <span class="hljs-keyword">out</span> kindFlags, <span class="hljs-keyword">out</span> targetFlags))
          <span class="hljs-keyword">return</span>;
      }

      Assert.Fail(<span class="hljs-string">&quot;Declared element is not marked as implicit use {0}&quot;</span>, xmlDocId);
    });
  }

  <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">AssertParameterAssertCondition</span>(<span class="hljs-keyword">string</span> xmlDocId, <span class="hljs-keyword">string</span> parameterName, AssertConditionType? conditionType)
  {
    AssertHelper(xmlDocId, (cache, element) =&gt;
    {
      <span class="hljs-keyword">var</span> parametersOwner = element <span class="hljs-keyword">as</span> IParametersOwner;
      Assert.NotNull(parametersOwner, <span class="hljs-string">&quot;Declared element is not an IParametersOwner {0}&quot;</span>, xmlDocId);

      <span class="hljs-keyword">var</span> parameter = parametersOwner.Parameters.SingleOrDefault(p =&gt; p.ShortName == parameterName);
      Assert.NotNull(parameter, <span class="hljs-string">&quot;Parameter \&quot;{0}\&quot; is not found on {1}&quot;</span>, parameterName, xmlDocId);

      <span class="hljs-keyword">var</span> actual = cache.GetParameterAssertionCondition(parameter);
      Assert.AreEqual(conditionType, actual);
    });
  }
}
</code></pre>
<p>Other assert methods can be added similar to <code>AssertParameterAssertCondition</code> that also call into <code>CodeAnnotationsCache</code> in order to assert annotations are applied.</p>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-4x fa-info"></strong>
<p> The prefix in the name of the XML Doc ID identifies the type of the code element - <code>T</code> for type, <code>M</code> for method, <code>P</code> for property and so on. See the <a href="http://msdn.microsoft.com/en-us/library/fsbx0t7x.aspx" target="_blank">MSDN documentation on XML Doc IDs</a> for more details.</p>
</blockquote>
<!-- Comment to separate the notes -->
<blockquote class="clearfix alert alert-warning"><strong class="fa fa-4x fa-exclamation-triangle"></strong>
<p> This approach requires that ReSharper can resolve the types and constructors of the <code>JetBrains.Annotations</code> attributes referenced in the external annotations file. If ReSharper cannot resolve these types, the annotations are not applied, and tests can fail.</p>
<p>ReSharper can automatically resolve types against the <code>JetBrains.Annotations.dll</code> assembly in the product install directory (by using a custom <code>IPsiModule</code>). In normal usage, this effectively means all projects can resolve references to the annotation attributes.</p>
<p>However, in tests, the product directory is the location of the test assembly, and the <code>JetBrains.Annotations.dll</code> assembly is not referenced in a test project, and therefore not copied to the <code>bin\Debug</code> folder. (It is not referenced simply because ReSharper itself doesn&apos;t include any binary references to the <code>.dll</code> to prevent versioning conflicts when multiple products are installed.)</p>
<p>This can be fixed in a couple of ways. Firstly, add a reference to <code>JetBrains.Annotations.dll</code> in your plugin test project, or a custom post-build step that copies <code>$(ReSharperSdkBinaries)\JetBrains.Annotations.dll</code> to the output folder.</p>
<p>Secondly, add <code>JetBrains.Annotations.dll</code> to the <code>[TestReferences]</code> attribute, and place a copy in the appropriate <code>test\data</code> location (<code>TestDataPath2</code> + <code>RelativeTestDataPath</code>).</p>
<p>Alternatively, add a C# source file to the temporary, in-memory test project that contains the source of the annotation attributes. The file will live in the location represented by <code>TestDataPath2</code> and <code>RelativeTestDataPath</code> (e.g. <code>&quot;test\data\&quot;</code> + <code>RelativeTestDataPath</code>). The contents of the file come from ReSharper&apos;s options dialog (ReSharper &#xBB; Options &#xBB; Code Inspection &#xBB; Code Annotations &#xBB; Copy default implementation to clipboard).</p>
<p>This approach works well, except the source file doesn&apos;t contain all annotations - older, obsolete annotations are not included (for example, <code>AssertionConditionAttribute</code>, while still supported, is not included in the default implementation, as it has been replaced by the more versatile <code>ContractAnnotationAttribute</code>). If you require the older annotations, add a binary reference.</p>
</blockquote>
<h2 id="testing-warnings-and-highlights"><a name="testing-warnings-and-highlights" class="plugin-anchor" href="#testing-warnings-and-highlights"><span class="fa fa-link"></span></a>Testing warnings and highlights</h2>
<p>Instead of testing that the annotations are applied to members, you can also test the highlights generated (or not) in response to the annotations, by deriving from <code>HighlightingTestBase</code> or one of its derived types, such as <code>CSharpHighlightingTestBase</code>.</p>
<p>This is a simple highlighting test, which analyses a source file and creates a temporary file that contains the text of the original file, plus a list of all highlights that are applied (if any). If the analysis is affected by external annotations, such as a <code>[NotNull]</code> annotation, extra highlights can be applied to the code that wouldn&apos;t be applied if the annotations weren&apos;t there. The temporary file, with the list of highlights, is compared to a previously stored &apos;gold&apos; file. If it differs, the test fails.</p>
<p>The tests can be run with the <code>DoOneTest</code> method, where the name of the source file is passed in, or by using the <code>DoNamedTest2</code> method, which takes the file name from the test method, minus any &apos;test&apos; prefix.</p>
<pre><code class="lang-cs">[Test]
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Should_show_annotations</span>()
{
  <span class="hljs-comment">// Looks for &apos;MyAnnotations.cs&apos;. The &apos;.cs&apos; is added automatically</span>
  DoOneTest(<span class="hljs-string">&quot;MyAnnotations&quot;</span>);
}

[Test]
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">TestMyAnnotations</span>()
{
  DoNamedTest2(); <span class="hljs-comment">// Looks for &apos;MyAnnotations.cs&apos;</span>
}
</code></pre>
<p>You might prefer to use this method over checking the annotations are applied as it checks the outcome of the annotation, rather than just that the annotation is applied. While this approach initially seems easier, it should be noted that each test requires a new source file for each scenario. The first approach, while requiring extra initial set up for creating the base class and importing <code>JetBrains.Annotations.dll</code>, makes each test a simple call to a helper method to assert the annotation. This might be easier if you have many annotations you wish to test.</p>

                    
                    </section>
                
                </div>
            </div>
        </div>

        
        
    </div>
</div>

        
<script src="../../gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
<script src="../../gitbook/app.js"></script>

<script>
require(["gitbook"], function(gitbook) {
    var config = {"richquotes":{"todos":true}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
