<!DOCTYPE HTML>
<html lang="en-US" manifest="../manifest.appcache">
    
    <head>
        
        <meta charset="UTF-8">
        <title>Navigating syntax trees | resharper-devguide</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 0.5.2">
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    <meta name="author" content="citizenmatt">
    
    
    

        
    </head>
    <body>
        
        
<link rel="stylesheet" href="../gitbook/style.css">

    
    <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-richquotes/plugin.css">
    


        
    <div class="book" data-github="citizenmatt/resharper-devguide" data-level="4.2" data-basepath=".." data-revision="1403274206027">
    <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    
    <a href="https://github.com/citizenmatt/resharper-devguide" target="_blank" class="btn pull-left home-bookmark" aria-label="GitHub home"><i class="fa fa-bookmark-o"></i></a>
    
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="btn-group btn-block">
        <button id="reduce-font-size" class="btn btn-default">A</button>
        <button id="enlarge-font-size" class="btn btn-default">A</button>
    </div>

    <ul class="list-group font-family-list">
        <li class="list-group-item" data-font="0">Serif</li>
        <li class="list-group-item" data-font="1">Sans</li>
    </ul>

    <div class="btn-group btn-group-xs btn-block color-theme-list">
        <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
    </div>
</div>

    </span>

    <!-- Actions Right -->
    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    

    
    <a href="https://github.com/citizenmatt/resharper-devguide/stargazers" target="_blank" class="btn pull-right count-star hidden-xs"><i class="fa fa-star-o"></i> Star (<span>-</span>)</a>
    <a href="https://github.com/citizenmatt/resharper-devguide/watchers" target="_blank" class="btn pull-right count-watch hidden-xs"><i class="fa fa-eye"></i> Watch (<span>-</span>)</a>
    

    <!-- Title -->
    <h1>
        <i class="fa fa-spinner fa-spin"></i>
        <a href="../" >resharper-devguide</a>
    </h1>
</div>

    



<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        <li>
            <a href="https://github.com/citizenmatt" target="blank" class="author-link">About the author</a>
        </li>
        

        
        
        <li>
            <a href="https://github.com/citizenmatt/resharper-devguide/issues" target="blank"class="issues-link">Questions and Issues</a>
        </li>
        

        
        
        <li>
            <a href="https://github.com/citizenmatt/resharper-devguide/edit/master/PSI/NavigatingSyntaxTrees.md" target="blank" class="contribute-link">Edit and Contribute</a>
        </li>
        

        
        <li class="divider"></li>
        

        <li class="" data-level="0" data-path="index.html">
            <a href="../index.html"><i class="fa fa-check"></i> Introduction</a>
        </li>

        
    
        <li>
            <ul class="part">
                
                
                    <li class="part-header " data-level="1" >
                        
                            <span>Part I</span>
                        
                    </li>
                
                
    
        
        <li class="chapter " data-level="1.1" data-path="wip.html">
            
                
                    <a href="../wip.html">
                        <i class="fa fa-check"></i> <b>1.</b> Work in progress
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.2" >
            
            <span><b>2.</b> Getting Started</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="1.2.1" >
            
            <span><b>2.1.</b> Tools</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="1.2.2" >
            
            <span><b>2.2.</b> Internal mode</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="1.2.3" >
            
            <span><b>2.3.</b> Platform Versioning</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="1.3" >
            
            <span><b>3.</b> Extensions Overview</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="1.3.1" >
            
            <span><b>3.1.</b> Live Templates</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="1.3.2" >
            
            <span><b>3.2.</b> Structural Search and Replace Patterns</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="1.3.3" >
            
            <span><b>3.3.</b> External Annotations</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="1.3.3.1" >
            
            <span><b>3.3.1.</b> Attribute Reference</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="1.3.3.2" >
            
            <span><b>3.3.2.</b> Annotator Tool</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="1.3.4" >
            
            <span><b>3.4.</b> Plugins and SDK</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="1.3.5" >
            
            <span><b>3.5.</b> Packaging and Distribution</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="1.4" data-path="HowDoI.html">
            
                
                    <a href="../HowDoI.html">
                        <i class="fa fa-check"></i> <b>4.</b> How do I?
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.5" >
            
            <span><b>5.</b> Plugins and SDK</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="1.5.1" >
            
            <span><b>5.1.</b> Debugging</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="1.5.2" data-path="Intro/KnownIssues.html">
            
                
                    <a href="../Intro/KnownIssues.html">
                        <i class="fa fa-check"></i> <b>5.2.</b> Known Issues
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.5.3" >
            
            <span><b>5.3.</b> Plugin testing</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="1.5.3.1" >
            
            <span><b>5.3.1.</b> Base classes</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="1.5.3.2" >
            
            <span><b>5.3.2.</b> Quick links</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="1.5.3.3" >
            
            <span><b>5.3.3.</b> Testing code completion</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="1.5.3.4" >
            
            <span><b>5.3.4.</b> Testing unit test support</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="1.5.3.5" >
            
            <span><b>5.3.5.</b> Testing new language support</span>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="1.6" data-path="Intro/Glossary.html">
            
                
                    <a href="../Intro/Glossary.html">
                        <i class="fa fa-check"></i> <b>6.</b> Glossary
                    </a>
                
            
            
        </li>
    

            </ul>
        </li>
    
        <li>
            <ul class="part">
                
                
                    <li class="part-header " data-level="2" >
                        
                            <span>Part II - Architectural Overview</span>
                        
                    </li>
                
                
    
        
        <li class="chapter " data-level="2.1" >
            
            <span><b>1.</b> Platform</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="2.2" >
            
            <span><b>2.</b> Project Model</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="2.3" >
            
            <span><b>3.</b> PSI</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="2.4" >
            
            <span><b>4.</b> Features</span>
            
            
        </li>
    

            </ul>
        </li>
    
        <li>
            <ul class="part">
                
                
                    <li class="part-header " data-level="3" >
                        
                            <span>Part III - Platform</span>
                        
                    </li>
                
                
    
        
        <li class="chapter " data-level="3.1" >
            
            <span><b>1.</b> Logging</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.2" >
            
            <span><b>2.</b> DataFlow</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.3" data-path="Platform/Lifetime.html">
            
                
                    <a href="../Platform/Lifetime.html">
                        <i class="fa fa-check"></i> <b>3.</b> Lifetime
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="3.3.1" data-path="Platform/Lifetime/Usage.html">
            
                
                    <a href="../Platform/Lifetime/Usage.html">
                        <i class="fa fa-check"></i> <b>3.1.</b> Usage
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.3.2" data-path="Platform/Lifetime/LifetimeDefinition.html">
            
                
                    <a href="../Platform/Lifetime/LifetimeDefinition.html">
                        <i class="fa fa-check"></i> <b>3.2.</b> Lifetime Management
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.3.3" data-path="Platform/Lifetime/Advanced.html">
            
                
                    <a href="../Platform/Lifetime/Advanced.html">
                        <i class="fa fa-check"></i> <b>3.3.</b> Advanced Lifetime Management
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.3.4" data-path="Platform/Lifetime/ComponentModel.html">
            
                
                    <a href="../Platform/Lifetime/ComponentModel.html">
                        <i class="fa fa-check"></i> <b>3.4.</b> Component Lifetime
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.3.5" data-path="Platform/Lifetime/CaseStudy.html">
            
                
                    <a href="../Platform/Lifetime/CaseStudy.html">
                        <i class="fa fa-check"></i> <b>3.5.</b> Case Study
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="3.4" >
            
            <span><b>4.</b> Component Model</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.5" >
            
            <span><b>5.</b> DataContext</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.6" >
            
            <span><b>6.</b> TextControl</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.7" >
            
            <span><b>7.</b> Documents</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.8" >
            
            <span><b>8.</b> Threading</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.9" >
            
            <span><b>9.</b> Locks</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.10" >
            
            <span><b>10.</b> Transactions</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.11" >
            
            <span><b>11.</b> IL Metadata</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.12" >
            
            <span><b>12.</b> Shell</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="3.12.1" >
            
            <span><b>12.1.</b> Visual Studio integration</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.12.2" >
            
            <span><b>12.2.</b> Command line</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.12.3" >
            
            <span><b>12.3.</b> Tool windows</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.12.4" >
            
            <span><b>12.4.</b> Icons</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.12.5" >
            
            <span><b>12.5.</b> Tooltips</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.12.6" >
            
            <span><b>12.6.</b> TreeView</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.12.7" >
            
            <span><b>12.7.</b> Progress reporting</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.12.8" >
            
            <span><b>12.8.</b> Popup menus</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.12.9" >
            
            <span><b>12.9.</b> Extensions</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.12.10" >
            
            <span><b>12.10.</b> Theming</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="3.13" >
            
            <span><b>13.</b> Project Model</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="3.13.1" >
            
            <span><b>13.1.</b> Change management</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.13.2" >
            
            <span><b>13.2.</b> MSBuild integration</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.13.3" >
            
            <span><b>13.3.</b> Project files</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="3.14" >
            
            <span><b>14.</b> Settings</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="3.14.1" >
            
            <span><b>14.1.</b> Reading and writing</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.14.2" >
            
            <span><b>14.2.</b> Defaults</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.14.3" >
            
            <span><b>14.3.</b> Layers</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.14.4" >
            
            <span><b>14.4.</b> File format</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="3.15" >
            
            <span><b>15.</b> Util</span>
            
            
        </li>
    

            </ul>
        </li>
    
        <li>
            <ul class="part">
                
                
                    <li class="part-header " data-level="4" >
                        
                            <span>Part IV - PSI</span>
                        
                    </li>
                
                
    
        
        <li class="chapter " data-level="4.1" >
            
            <span><b>1.</b> Syntax trees</span>
            
            
        </li>
    
        
        <li class="chapter active" data-level="4.2" data-path="PSI/NavigatingSyntaxTrees.html">
            
                
                    <a href="../PSI/NavigatingSyntaxTrees.html">
                        <i class="fa fa-check"></i> <b>2.</b> Navigating syntax trees
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="4.2.1" >
            
            <span><b>2.1.</b> Helper methods</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.2.2" data-path="PSI/SyntaxTrees/StronglyTypedNavigation.html">
            
                
                    <a href="../PSI/SyntaxTrees/StronglyTypedNavigation.html">
                        <i class="fa fa-check"></i> <b>2.2.</b> Strongly typed navigation
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.2.3" >
            
            <span><b>2.3.</b> Recursive navigation</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.2.4" >
            
            <span><b>2.4.</b> Finding nodes</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="4.3" >
            
            <span><b>3.</b> Manipulating syntax trees</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.4" >
            
            <span><b>4.</b> References</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.5" >
            
            <span><b>5.</b> Generating code</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.6" >
            
            <span><b>6.</b> Semantic models</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.7" >
            
            <span><b>7.</b> Path and color references</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.8" >
            
            <span><b>8.</b> Control flow</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.9" >
            
            <span><b>9.</b> Caches</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.10" >
            
            <span><b>10.</b> PSI Implementations Reference</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="4.10.1" >
            
            <span><b>10.1.</b> C#</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.10.2" >
            
            <span><b>10.2.</b> Visual Basic</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.10.3" >
            
            <span><b>10.3.</b> JavaScript</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.10.4" >
            
            <span><b>10.4.</b> TypeScript</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.10.5" >
            
            <span><b>10.5.</b> JSON</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.10.6" >
            
            <span><b>10.6.</b> HTML</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.10.7" >
            
            <span><b>10.7.</b> CSS</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.10.8" >
            
            <span><b>10.8.</b> Razor</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.10.9" >
            
            <span><b>10.9.</b> ASP.net</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.10.10" >
            
            <span><b>10.10.</b> XML</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.10.11" >
            
            <span><b>10.11.</b> Build scripts</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.10.12" >
            
            <span><b>10.12.</b> XAML</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.10.13" >
            
            <span><b>10.13.</b> XML Doc</span>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
        </li>
    
        <li>
            <ul class="part">
                
                
                    <li class="part-header " data-level="5" >
                        
                            <span>Part V - Features</span>
                        
                    </li>
                
                
    
        
        <li class="chapter " data-level="5.1" >
            
            <span><b>1.</b> Analysis</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.1.1" >
            
            <span><b>1.1.</b> Highlights</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.1.2" >
            
            <span><b>1.2.</b> Custom highlights</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.1.3" >
            
            <span><b>1.3.</b> Suppressing highlights</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.1.4" >
            
            <span><b>1.4.</b> Daemons</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.1.5" >
            
            <span><b>1.5.</b> Element problem analysers</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.1.6" >
            
            <span><b>1.6.</b> Xml and Html analysers</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.1.7" >
            
            <span><b>1.7.</b> Solution Wide Analysis</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.1.8" >
            
            <span><b>1.8.</b> Error Stripe</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.1.9" >
            
            <span><b>1.9.</b> Syntax Highlighting</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.1.10" >
            
            <span><b>1.10.</b> Caches again</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.1.11" >
            
            <span><b>1.11.</b> Value analysis</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.1.12" >
            
            <span><b>1.12.</b> Call hierarchy</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5.2" >
            
            <span><b>2.</b> Actions</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.2.1" >
            
            <span><b>2.1.</b> Menu items</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.2.2" >
            
            <span><b>2.2.</b> Quick fixes</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.2.3" >
            
            <span><b>2.3.</b> Context actions</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.2.4" >
            
            <span><b>2.4.</b> Bulk actions</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.2.5" >
            
            <span><b>2.5.</b> Overriding</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.2.6" >
            
            <span><b>2.6.</b> Temporary editor actions</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.2.7" >
            
            <span><b>2.7.</b> Action ID reference </span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5.3" >
            
            <span><b>3.</b> Code Completion</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.3.1" >
            
            <span><b>3.1.</b> Basic, smart and import</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.3.2" >
            
            <span><b>3.2.</b> Dynamic completion</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.3.3" >
            
            <span><b>3.3.</b> Double completion</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.3.4" >
            
            <span><b>3.4.</b> Lookup items</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5.4" >
            
            <span><b>4.</b> Contextual highlighting</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.4.1" >
            
            <span><b>4.1.</b> Brace matching</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.4.2" >
            
            <span><b>4.2.</b> string.Format style highlighting</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.4.3" >
            
            <span><b>4.3.</b> Find usages in file style highlighting</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5.5" >
            
            <span><b>5.</b> Popup docs</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.5.1" >
            
            <span><b>5.1.</b> Quick Doc</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.5.2" >
            
            <span><b>5.2.</b> Parameter Info</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5.6" >
            
            <span><b>6.</b> Refactoring</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.6.1" >
            
            <span><b>6.1.</b> Workflow</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.6.2" >
            
            <span><b>6.2.</b> Integrating</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.6.3" >
            
            <span><b>6.3.</b> Renaming</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.6.4" >
            
            <span><b>6.4.</b> Unused references</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5.7" >
            
            <span><b>7.</b> Generate This</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.8" >
            
            <span><b>8.</b> Navigation</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.8.1" >
            
            <span><b>8.1.</b> Go to everything</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.8.2" >
            
            <span><b>8.2.</b> Go to related</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.8.3" >
            
            <span><b>8.3.</b> Go to next/prev</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.8.4" >
            
            <span><b>8.4.</b> Contextual - find exits</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.8.5" >
            
            <span><b>8.5.</b> Navigate from here</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.8.6" >
            
            <span><b>8.6.</b> Occurrences</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5.9" >
            
            <span><b>9.</b> Tools</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.9.1" >
            
            <span><b>9.1.</b> Code cleanup</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.9.2" >
            
            <span><b>9.2.</b> Code structure</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.9.3" >
            
            <span><b>9.3.</b> Todo items</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.9.4" >
            
            <span><b>9.4.</b> Bookmarks</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.9.5" >
            
            <span><b>9.5.</b> Assembly explorer</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5.10" >
            
            <span><b>10.</b> Naming</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.10.1" >
            
            <span><b>10.1.</b> Suggestions</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.10.2" >
            
            <span><b>10.2.</b> Policy</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5.11" >
            
            <span><b>11.</b> Editing</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.11.1" >
            
            <span><b>11.1.</b> Formatting</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.11.2" >
            
            <span><b>11.2.</b> Typing assist</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.11.3" >
            
            <span><b>11.3.</b> Complete statement</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.11.4" >
            
            <span><b>11.4.</b> Extend selection</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.11.5" >
            
            <span><b>11.5.</b> Rearrange code</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.11.6" >
            
            <span><b>11.6.</b> Comments</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5.12" >
            
            <span><b>12.</b> Structural Search and Replace</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.12.1" >
            
            <span><b>12.1.</b> C# vs HTML and CSS</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.12.2" >
            
            <span><b>12.2.</b> Progammatic usage</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5.13" >
            
            <span><b>13.</b> Live Templates</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.13.1" >
            
            <span><b>13.1.</b> Macros</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.13.2" >
            
            <span><b>13.2.</b> Scopes and categories</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.13.3" >
            
            <span><b>13.3.</b> Hotspots</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.13.4" >
            
            <span><b>13.4.</b> Programmatic usage</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5.14" >
            
            <span><b>14.</b> Unit Test</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.14.1" >
            
            <span><b>14.1.</b> Test discovery</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.14.2" >
            
            <span><b>14.2.</b> Test execution</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.14.3" >
            
            <span><b>14.3.</b> Non-CLR tests</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5.15" >
            
            <span><b>15.</b> Diagramming</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.15.1" >
            
            <span><b>15.1.</b> Architecture diagrams</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5.16" >
            
            <span><b>16.</b> External sources</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.16.1" >
            
            <span><b>16.1.</b> PDB symbols</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.16.2" >
            
            <span><b>16.2.</b> Decompiling</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.16.3" >
            
            <span><b>16.3.</b> Source servers</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5.17" >
            
            <span><b>17.</b> Asp.net MVC</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.18" >
            
            <span><b>18.</b> Internationalisation</span>
            
            
        </li>
    

            </ul>
        </li>
    
        <li>
            <ul class="part">
                
                
                    <li class="part-header " data-level="6" >
                        
                            <span>Part VI - Custom languages</span>
                        
                    </li>
                
                
    
        
        <li class="chapter " data-level="6.1" >
            
            <span><b>1.</b> Disabling language support</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.2" >
            
            <span><b>2.</b> Project model language support</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.3" >
            
            <span><b>3.</b> PSI language support</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.4" >
            
            <span><b>4.</b> Secondary PSI</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.5" >
            
            <span><b>5.</b> Injected PSI</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.6" >
            
            <span><b>6.</b> Lexing and parsing</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.7" >
            
            <span><b>7.</b> psi files</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.8" >
            
            <span><b>8.</b> PsiGen</span>
            
            
        </li>
    

            </ul>
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Generated using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 91.66666666666667%;min-width: 83.33333333333333%;"></div>
    </div>
    <div class="chapters">
    
        <a href="../index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="../wip.html" title="Work in progress" class="chapter done " data-progress="1.1" style="left: 8.333333333333334%;"></a>
    
        <a href="../HowDoI.html" title="How do I?" class="chapter done " data-progress="1.4" style="left: 16.666666666666668%;"></a>
    
        <a href="../Intro/KnownIssues.html" title="Known Issues" class="chapter done " data-progress="1.5.2" style="left: 25%;"></a>
    
        <a href="../Intro/Glossary.html" title="Glossary" class="chapter done " data-progress="1.6" style="left: 33.333333333333336%;"></a>
    
        <a href="../Platform/Lifetime.html" title="Lifetime" class="chapter done " data-progress="3.3" style="left: 41.666666666666664%;"></a>
    
        <a href="../Platform/Lifetime/Usage.html" title="Usage" class="chapter done " data-progress="3.3.1" style="left: 50%;"></a>
    
        <a href="../Platform/Lifetime/LifetimeDefinition.html" title="Lifetime Management" class="chapter done " data-progress="3.3.2" style="left: 58.333333333333336%;"></a>
    
        <a href="../Platform/Lifetime/Advanced.html" title="Advanced Lifetime Management" class="chapter done " data-progress="3.3.3" style="left: 66.66666666666667%;"></a>
    
        <a href="../Platform/Lifetime/ComponentModel.html" title="Component Lifetime" class="chapter done " data-progress="3.3.4" style="left: 75%;"></a>
    
        <a href="../Platform/Lifetime/CaseStudy.html" title="Case Study" class="chapter done " data-progress="3.3.5" style="left: 83.33333333333333%;"></a>
    
        <a href="../PSI/NavigatingSyntaxTrees.html" title="Navigating syntax trees" class="chapter done " data-progress="4.2" style="left: 91.66666666666667%;"></a>
    
        <a href="../PSI/SyntaxTrees/StronglyTypedNavigation.html" title="Strongly typed navigation" class="chapter  " data-progress="4.2.2" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_1">
                    
                        <h1 id="navigating-syntax-trees">Navigating syntax trees</h1>
<p>Every node in the syntax tree implements <code>ITreeNode</code>. The interface includes members pertinent to navigating and processing the tree. These members are shown below (other members removed for brevity):</p>
<pre><code class="lang-cs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> ITreeNode
{
  ITreeNode Parent { <span class="hljs-keyword">get</span>; }
  ITreeNode FirstChild { <span class="hljs-keyword">get</span>; }
  ITreeNode LastChild  { <span class="hljs-keyword">get</span>; }
  ITreeNode NextSibling { <span class="hljs-keyword">get</span>; }
  ITreeNode PrevSibling { <span class="hljs-keyword">get</span>; }

  <span class="hljs-comment">// [...snip...]</span>
}
</code></pre>
<p>There are several ways of navigating the tree.</p>
<ul>
<li>Manually walking the tree, using the interface members shown above</li>
<li>Use the helper methods to manually walk the tree</li>
<li>Use <a href="SyntaxTrees/StronglyTypedNavigation.html">strongly typed navigation</a>, using accessors on derived <code>ITreeNode</code> implementations, and the strongly typed &quot;navigator&quot; classes</li>
<li>Process the tree using the <a href="SyntaxTrees/RecursiveNavigation.html">visitor pattern or the <code>IRecursiveElementProcessor</code> set of classes</a></li>
<li>Finding child or parent nodes of a specific type</li>
</ul>
<h2 id="manually-navigating-the-tree">Manually navigating the tree</h2>
<p>Manually walking the tree is the lowest level means of navigation, and involves walking the nodes using the properties shown above.</p>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-4x fa-edit"></strong>
<p> Generally speaking, you&#39;ll want to use one of the other, less low level, navigation techniques in this section to navigate around the tree. However, it is useful to know how to navigate the tree in order to understand how the tree is structured.</p>
</blockquote>
<h3 id="walking-up-the-tree">Walking up the tree</h3>
<p>You can walk up the tree using the <code>Parent</code> property. This is very useful for finding the context that the current node is in - for example, you can walk the <code>Parent</code> property of a method invocation to see if the invocation is happening inside a method declaration that is async or not.</p>
<p>To walk the <code>Parent</code> property, you will want to write code like this:</p>
<pre><code class="lang-cs"><span class="hljs-keyword">while</span>(currentNode != <span class="hljs-keyword">null</span>)
{
  <span class="hljs-comment">// Process node</span>
  currentNode = currentNode.Parent;
}
</code></pre>
<h3 id="walking-sibling-nodes">Walking sibling nodes</h3>
<p>Since a file is parsed into a tree structure, nodes have siblings as well as children. For example, a C# file can have a class declaration that contains multiple methods. Each method is represented by an <code>IMethodDeclaration</code> node. Intuitively, each method is a child of the class, and therefore are siblings, and no method is higher or lower in the tree than any other.</p>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-4x fa-edit"></strong>
<p> Even though the method declarations will be siblings, they are not going to be direct siblings. The syntax tree is a full-fidelity representation of the C# file, which means the whitespace and comments between the method declarations are also added as nodes in the tree, and these will be siblings to the method declarations.</p>
</blockquote>
<p>You can walk the siblings with code like this:</p>
<pre><code class="lang-cs"><span class="hljs-keyword">while</span>(currentNode != <span class="hljs-keyword">null</span>)
{
  <span class="hljs-comment">// Process node</span>
  currentNode = currentNode.NextSibling;
}
</code></pre>
<p>Obviously the code to walk the sibling chain in reverse is just the same, but using the <code>PrevSibling</code> property.</p>
<h3 id="walking-down-the-tree">Walking down the tree</h3>
<p>Walking down the tree is very similar to walking the sibling chain. Again, since this is a tree structure a single node can have multiple children. For example, a C# file&#39;s list of <code>using</code> statements is represented by an <code>IUsingList</code> node, and this will have multiple children - multiple instances of <code>IUsingNamespaceDirective</code> (with each child again separated by whitespace nodes).</p>
<p>To walk the immediate children of a node, you&#39;ll want to write code like this:</p>
<pre><code class="lang-cs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">WalkChildren</span>(ITreeNode root)
{
  <span class="hljs-keyword">var</span> child = root.FirstChild;
  <span class="hljs-keyword">while</span>(child != <span class="hljs-keyword">null</span>)
  {
    <span class="hljs-comment">// Process child node</span>
    child = child.NextSibling;
  }
}
</code></pre>
<p>Note that we start with <code>FirstChild</code> but then walk that child&#39;s siblings. To walk the children in reverse order, start with <code>LastChild</code>, and walk <code>PrevSibling</code>.</p>
<p>If you want to walk all descendants of a node, simply recursively walk a child node&#39;s children.</p>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-4x fa-edit"></strong>
<p> Beware of recursively walking the descendants of a node. Recursion can run into problems with a very deeply nested syntax tree. It is better to iteratively walk the tree than to use recursion.</p>
<p>You should avoid writing your own methods for walking the tree, and make use of the <a href="SyntaxTrees/RecursiveNavigation.html"><code>TreeNodeVisitor</code> or <code>IRecursiveElementProcessor</code></a> patterns that ReSharper implements.</p>
</blockquote>

                    
                    </section>
                
                </div>
            </div>
        </div>

        
        
    </div>
</div>

        
<script src="../gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
<script src="../gitbook/app.js"></script>

<script>
require(["gitbook"], function(gitbook) {
    var config = {};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
