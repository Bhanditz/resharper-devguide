<!DOCTYPE HTML>
<html lang="en-US" manifest="../../manifest.appcache">
    
    <head>
        
        <meta charset="UTF-8">
        <title>Scopes | ReSharper DevGuide</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 0.7.1">
        <meta name="HandheldFriendly" content="true">
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    <meta name="author" content="citizenmatt">
    
    
    
    <link rel="prev" href="../../Features/LiveTemplates/Macros.html">
    

        
    </head>
    <body>
        
        
<link rel="stylesheet" href="../../gitbook/style.css">

    
    <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-richquotes/plugin.css">
    

    
    <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-anchors/plugin.css">
    

    
    <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-multipart/multipart.css">
    

    
    <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-scrollablecode/scrollablecode.css">
    


        
    <div class="book" data-github="citizenmatt/resharper-devguide" data-level="6.14.2" data-basepath="../.." data-revision="1408111735719">
    <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    
    <a href="https://github.com/citizenmatt/resharper-devguide" target="_blank" class="btn pull-left home-bookmark" aria-label="GitHub home"><i class="fa fa-bookmark-o"></i></a>
    
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="btn-group btn-block">
        <button id="reduce-font-size" class="btn btn-default">A</button>
        <button id="enlarge-font-size" class="btn btn-default">A</button>
    </div>

    <ul class="list-group font-family-list">
        <li class="list-group-item" data-font="0">Serif</li>
        <li class="list-group-item" data-font="1">Sans</li>
    </ul>

    <div class="btn-group btn-group-xs btn-block color-theme-list">
        <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
    </div>
</div>

    </span>

    <!-- Actions Right -->
    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-spinner fa-spin"></i>
        <a href="../../">ReSharper DevGuide</a>
    </h1>
</div>

    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control">
    </div>
    <ul class="summary">
        
        
        
        <li>
            <a href="https://github.com/citizenmatt" target="blank" class="author-link">About the author</a>
        </li>
        

        
        
        <li>
            <a href="https://github.com/citizenmatt/resharper-devguide/issues" target="blank" class="issues-link">Questions and Issues</a>
        </li>
        

        
        
        <li>
            <a href="https://github.com/citizenmatt/resharper-devguide/edit/master/Features/LiveTemplates/Scopes.md" target="blank" class="contribute-link">Edit and Contribute</a>
        </li>
        

	

        
        <li class="divider"></li>
        

        
    
        
        <li class="part" data-level="0" data-path="index.html">
            
                
                    <a href="../../index.html">
                        <i class="fa fa-check"></i>
                        
                         Introduction
                    </a>
                
            
            
        </li>
    
        
        <li class="part" data-level="1">
            
            <span> Prefix</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="1.1" data-path="StyleGuide.html">
            
                
                    <a href="../../StyleGuide.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                         Style guide
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.2" data-path="wip.html">
            
                
                    <a href="../../wip.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                         Work in progress
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="part" data-level="2">
            
            <span> Part I</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="2.1">
            
            <span><b>1.</b> Getting Started</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="2.1.1" data-path="Intro/Tools.html">
            
                
                    <a href="../../Intro/Tools.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                         Tools
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.1.2">
            
            <span><b>1.2.</b> Internal mode</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="2.1.3">
            
            <span><b>1.3.</b> Platform Versioning</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="2.2">
            
            <span><b>2.</b> Extensions Overview</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="2.2.1">
            
            <span><b>2.1.</b> Live Templates</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="2.2.2">
            
            <span><b>2.2.</b> Structural Search and Replace Patterns</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="2.2.3">
            
            <span><b>2.3.</b> External Annotations</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="2.2.3.1">
            
            <span><b>2.3.1.</b> Attribute Reference</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="2.2.3.2">
            
            <span><b>2.3.2.</b> Annotator Tool</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="2.2.4">
            
            <span><b>2.4.</b> Plugins and SDK</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="2.2.5" data-path="Extensions/Packaging.html">
            
                
                    <a href="../../Extensions/Packaging.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.</b>
                        
                         Packaging and Distribution
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.2.6">
            
            <span><b>2.6.</b> Troubleshooting</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="2.3" data-path="HowDoI.html">
            
                
                    <a href="../../HowDoI.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                         How do I?
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.4">
            
            <span><b>4.</b> Plugins and SDK</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="2.4.1" data-path="Plugins/SDK.html">
            
                
                    <a href="../../Plugins/SDK.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                         SDK Reference
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.4.2" data-path="Plugins/ProjectSetup.html">
            
                
                    <a href="../../Plugins/ProjectSetup.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                         Project Setup
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.4.3">
            
            <span><b>4.3.</b> Debugging</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="2.4.4" data-path="Intro/KnownIssues.html">
            
                
                    <a href="../../Intro/KnownIssues.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.4.</b>
                        
                         Known Issues
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.4.5" data-path="Plugins/Testing.html">
            
                
                    <a href="../../Plugins/Testing.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.5.</b>
                        
                         Plugin testing
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="2.4.5.1">
            
            <span><b>4.5.1.</b> Base classes</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="2.4.5.2" data-path="Plugins/TemporarySettings.html">
            
                
                    <a href="../../Plugins/TemporarySettings.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.5.2.</b>
                        
                         Temporary Settings
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.4.5.3">
            
            <span><b>4.5.3.</b> Quick links</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="2.4.5.4">
            
            <span><b>4.5.4.</b> Testing code completion</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="2.4.5.5">
            
            <span><b>4.5.5.</b> Testing unit test support</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="2.4.5.6">
            
            <span><b>4.5.6.</b> Testing new language support</span>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="2.5" data-path="Intro/Glossary.html">
            
                
                    <a href="../../Intro/Glossary.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                         Glossary
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="part" data-level="3">
            
            <span> Part II - Architectural Overview</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="3.1" data-path="Architecture/Overview.html">
            
                
                    <a href="../../Architecture/Overview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                         Overview
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.2">
            
            <span><b>2.</b> Platform</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.3">
            
            <span><b>3.</b> Project Model</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.4">
            
            <span><b>4.</b> PSI</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="3.5">
            
            <span><b>5.</b> Features</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="part" data-level="4">
            
            <span> Part III - Platform</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="4.1">
            
            <span><b>1.</b> Logging</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.2">
            
            <span><b>2.</b> DataFlow</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.3" data-path="Platform/Lifetime.html">
            
                
                    <a href="../../Platform/Lifetime.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                         Lifetime
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="4.3.1" data-path="Platform/Lifetime/Usage.html">
            
                
                    <a href="../../Platform/Lifetime/Usage.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                         Usage
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.3.2" data-path="Platform/Lifetime/LifetimeDefinition.html">
            
                
                    <a href="../../Platform/Lifetime/LifetimeDefinition.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                         Lifetime Management
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.3.3" data-path="Platform/Lifetime/Advanced.html">
            
                
                    <a href="../../Platform/Lifetime/Advanced.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                         Advanced Lifetime Management
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.3.4" data-path="Platform/Lifetime/ComponentModel.html">
            
                
                    <a href="../../Platform/Lifetime/ComponentModel.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                         Component Lifetime
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.3.5" data-path="Platform/Lifetime/CaseStudy.html">
            
                
                    <a href="../../Platform/Lifetime/CaseStudy.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                         Case Study
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="4.4" data-path="Platform/ComponentModel.html">
            
                
                    <a href="../../Platform/ComponentModel.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                         Component Model
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="4.4.1" data-path="Platform/VisualStudio/ComponentModel.html">
            
                
                    <a href="../../Platform/VisualStudio/ComponentModel.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                         Visual Studio interfaces
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="4.5">
            
            <span><b>5.</b> DataContext</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.6" data-path="Platform/TextControl.html">
            
                
                    <a href="../../Platform/TextControl.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                         TextControl
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.7">
            
            <span><b>7.</b> Documents</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.8">
            
            <span><b>8.</b> Threading</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.9">
            
            <span><b>9.</b> Locks</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.10">
            
            <span><b>10.</b> Transactions</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.11">
            
            <span><b>11.</b> IL Metadata</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.12">
            
            <span><b>12.</b> Shell</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="4.12.1">
            
            <span><b>12.1.</b> Visual Studio integration</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="4.12.1.1" data-path="Platform/VisualStudio/CustomHives.html">
            
                
                    <a href="../../Platform/VisualStudio/CustomHives.html">
                        <i class="fa fa-check"></i>
                        
                            <b>12.1.1.</b>
                        
                         Experimental Instances
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="4.12.2">
            
            <span><b>12.2.</b> Command line</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.12.3" data-path="Platform/Shell/ToolWindows.html">
            
                
                    <a href="../../Platform/Shell/ToolWindows.html">
                        <i class="fa fa-check"></i>
                        
                            <b>12.3.</b>
                        
                         Tool windows
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.12.4" data-path="Platform/Shell/Icons.html">
            
                
                    <a href="../../Platform/Shell/Icons.html">
                        <i class="fa fa-check"></i>
                        
                            <b>12.4.</b>
                        
                         Icons
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.12.5">
            
            <span><b>12.5.</b> Tooltips</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.12.6">
            
            <span><b>12.6.</b> TreeView</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.12.7">
            
            <span><b>12.7.</b> Progress reporting</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.12.8">
            
            <span><b>12.8.</b> Popup menus</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.12.9">
            
            <span><b>12.9.</b> Extensions</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.12.10">
            
            <span><b>12.10.</b> Theming</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="4.13">
            
            <span><b>13.</b> Project Model</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="4.13.1">
            
            <span><b>13.1.</b> Change management</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.13.2">
            
            <span><b>13.2.</b> MSBuild integration</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.13.3">
            
            <span><b>13.3.</b> Project files</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="4.14" data-path="Platform/Settings.html">
            
                
                    <a href="../../Platform/Settings.html">
                        <i class="fa fa-check"></i>
                        
                            <b>14.</b>
                        
                         Settings
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="4.14.1">
            
            <span><b>14.1.</b> Reading and writing</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.14.2">
            
            <span><b>14.2.</b> Defaults</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.14.3">
            
            <span><b>14.3.</b> Layers</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.14.4">
            
            <span><b>14.4.</b> File format</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="4.14.5">
            
            <span><b>14.5.</b> Util</span>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="part" data-level="5">
            
            <span> Part IV - PSI</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.1">
            
            <span><b>1.</b> Syntax trees</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.2" data-path="PSI/NavigatingSyntaxTrees.html">
            
                
                    <a href="../../PSI/NavigatingSyntaxTrees.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                         Navigating syntax trees
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.2.1">
            
            <span><b>2.1.</b> Helper methods</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.2.2" data-path="PSI/SyntaxTrees/StronglyTypedNavigation.html">
            
                
                    <a href="../../PSI/SyntaxTrees/StronglyTypedNavigation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                         Strongly typed navigation
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.2.3">
            
            <span><b>2.3.</b> Recursive navigation</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.2.4">
            
            <span><b>2.4.</b> Finding nodes</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5.3">
            
            <span><b>3.</b> Manipulating syntax trees</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.4">
            
            <span><b>4.</b> References</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.4.1">
            
            <span><b>4.1.</b> Resolving references</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.4.2" data-path="PSI/References/ReferenceProviders.html">
            
                
                    <a href="../../PSI/References/ReferenceProviders.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                         Reference providers
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.4.3" data-path="PSI/References/CodeCompletion.html">
            
                
                    <a href="../../PSI/References/CodeCompletion.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.</b>
                        
                         Code Completion
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.4.4" data-path="PSI/References/Substrings.html">
            
                
                    <a href="../../PSI/References/Substrings.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.4.</b>
                        
                         References within elements
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.4.5" data-path="PSI/References/IReferenceProvider.html">
            
                
                    <a href="../../PSI/References/IReferenceProvider.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.5.</b>
                        
                         Managing reference providers
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.4.6" data-path="PSI/References/PathReferences.html">
            
                
                    <a href="../../PSI/References/PathReferences.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.6.</b>
                        
                         Path references
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.4.7">
            
            <span><b>4.7.</b> Colour references</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5.5" data-path="PSI/Generating/Code.html">
            
                
                    <a href="../../PSI/Generating/Code.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                         Generating code
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.5.1" data-path="PSI/Generating/Comments.html">
            
                
                    <a href="../../PSI/Generating/Comments.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                         Generating comments
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5.6">
            
            <span><b>6.</b> Semantic models</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.6.1" data-path="PSI/TypeSystem.html">
            
                
                    <a href="../../PSI/TypeSystem.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.</b>
                        
                         Type system
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5.7">
            
            <span><b>7.</b> Control flow</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.8" data-path="PSI/Caches.html">
            
                
                    <a href="../../PSI/Caches.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                         Caches
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.9">
            
            <span><b>9.</b> External Annotations</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.9.1" data-path="PSI/ExternalAnnotations/Testing.html">
            
                
                    <a href="../../PSI/ExternalAnnotations/Testing.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.1.</b>
                        
                         Testing
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5.10">
            
            <span><b>10.</b> PSI Implementations Reference</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.10.1">
            
            <span><b>10.1.</b> C#</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.10.2">
            
            <span><b>10.2.</b> Visual Basic</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.10.3">
            
            <span><b>10.3.</b> JavaScript</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.10.4">
            
            <span><b>10.4.</b> TypeScript</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.10.5">
            
            <span><b>10.5.</b> JSON</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.10.6">
            
            <span><b>10.6.</b> HTML</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.10.7">
            
            <span><b>10.7.</b> CSS</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.10.8">
            
            <span><b>10.8.</b> Razor</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.10.9">
            
            <span><b>10.9.</b> ASP.net</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.10.10" data-path="PSI/Reference/Xml/Overview.html">
            
                
                    <a href="../../PSI/Reference/Xml/Overview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.10.</b>
                        
                         XML and DTD
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.10.10.1" data-path="PSI/Reference/Xml/Navigators.html">
            
                
                    <a href="../../PSI/Reference/Xml/Navigators.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.10.1.</b>
                        
                         Navigators
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.10.10.2" data-path="PSI/Reference/Xml/Utils.html">
            
                
                    <a href="../../PSI/Reference/Xml/Utils.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.10.2.</b>
                        
                         Utils
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.10.10.3" data-path="PSI/Reference/Xml/TreeNodes.html">
            
                
                    <a href="../../PSI/Reference/Xml/TreeNodes.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.10.3.</b>
                        
                         Tree Nodes
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.10.10.4" data-path="PSI/Reference/Xml/TreeNodesDTD.html">
            
                
                    <a href="../../PSI/Reference/Xml/TreeNodesDTD.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.10.4.</b>
                        
                         Tree Nodes (DTD)
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5.10.11">
            
            <span><b>10.11.</b> Build scripts</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.10.12">
            
            <span><b>10.12.</b> XAML</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="5.10.13">
            
            <span><b>10.13.</b> XML Doc</span>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="part" data-level="6">
            
            <span> Part V - Features</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.1">
            
            <span><b>1.</b> Analysis</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.1.1">
            
            <span><b>1.1.</b> Highlights</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.2">
            
            <span><b>1.2.</b> Custom highlights</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.3">
            
            <span><b>1.3.</b> Suppressing highlights</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.4" data-path="Features/Analysis/Daemons.html">
            
                
                    <a href="../../Features/Analysis/Daemons.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.4.</b>
                        
                         Daemons
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.5">
            
            <span><b>1.5.</b> Element problem analysers</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.6">
            
            <span><b>1.6.</b> Xml and Html analysers</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.7">
            
            <span><b>1.7.</b> Solution Wide Analysis</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.8">
            
            <span><b>1.8.</b> Error Stripe</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.9">
            
            <span><b>1.9.</b> Syntax Highlighting</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.10">
            
            <span><b>1.10.</b> Caches again</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.11">
            
            <span><b>1.11.</b> Value analysis</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.12">
            
            <span><b>1.12.</b> Call hierarchy</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.2" data-path="Features/Actions.html">
            
                
                    <a href="../../Features/Actions.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                         Actions
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.2.1">
            
            <span><b>2.1.</b> Menu items</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.2.2" data-path="Features/Actions/QuickFixes.html">
            
                
                    <a href="../../Features/Actions/QuickFixes.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                         Quick fixes
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.2.3">
            
            <span><b>2.3.</b> Context actions</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.2.4" data-path="Features/Actions/Bulk.html">
            
                
                    <a href="../../Features/Actions/Bulk.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                         Bulk actions
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.2.5">
            
            <span><b>2.5.</b> Overriding</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.2.6">
            
            <span><b>2.6.</b> Temporary editor actions</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.2.7">
            
            <span><b>2.7.</b> Action ID reference</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.3" data-path="Features/Completion.html">
            
                
                    <a href="../../Features/Completion.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                         Code Completion
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.3.1">
            
            <span><b>3.1.</b> Basic, smart and import</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.3.2">
            
            <span><b>3.2.</b> Dynamic completion</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.3.3">
            
            <span><b>3.3.</b> Double completion</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.3.4">
            
            <span><b>3.4.</b> Lookup items</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.4">
            
            <span><b>4.</b> Contextual highlighting</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.4.1">
            
            <span><b>4.1.</b> Brace matching</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.4.2">
            
            <span><b>4.2.</b> string.Format style highlighting</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.4.3">
            
            <span><b>4.3.</b> Find usages in file style highlighting</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.5">
            
            <span><b>5.</b> Popup docs</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.5.1" data-path="Features/QuickDoc/Overview.html">
            
                
                    <a href="../../Features/QuickDoc/Overview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                         Quick Doc
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.5.1.1" data-path="Features/QuickDoc/ImplementingProvider.html">
            
                
                    <a href="../../Features/QuickDoc/ImplementingProvider.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.1.</b>
                        
                         IQuickDocProvider
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.5.1.2" data-path="Features/QuickDoc/ImplementingPresenter.html">
            
                
                    <a href="../../Features/QuickDoc/ImplementingPresenter.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.2.</b>
                        
                         IQuickDocPresenter
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.5.1.3" data-path="Features/QuickDoc/HelperClasses.html">
            
                
                    <a href="../../Features/QuickDoc/HelperClasses.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.3.</b>
                        
                         Helper classes
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.5.1.4" data-path="Features/QuickDoc/ExistingProviders.html">
            
                
                    <a href="../../Features/QuickDoc/ExistingProviders.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.4.</b>
                        
                         Existing providers
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.5.1.5" data-path="Features/QuickDoc/Testing.html">
            
                
                    <a href="../../Features/QuickDoc/Testing.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.5.</b>
                        
                         Testing
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.5.2">
            
            <span><b>5.2.</b> Parameter Info</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.6" data-path="Features/Refactoring.html">
            
                
                    <a href="../../Features/Refactoring.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                         Refactoring
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.6.1">
            
            <span><b>6.1.</b> Workflow</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.6.2">
            
            <span><b>6.2.</b> Integrating</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.6.3">
            
            <span><b>6.3.</b> Renaming</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.6.4">
            
            <span><b>6.4.</b> Unused references</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.7" data-path="Features/GenerateMenu.html">
            
                
                    <a href="../../Features/GenerateMenu.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                         Generate Menu
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.8" data-path="Features/Navigation.html">
            
                
                    <a href="../../Features/Navigation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                         Navigation
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.8.1">
            
            <span><b>8.1.</b> Go to everything</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.8.2">
            
            <span><b>8.2.</b> Go to related</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.8.3">
            
            <span><b>8.3.</b> Go to next/prev</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.8.4">
            
            <span><b>8.4.</b> Contextual - find exits</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.8.5">
            
            <span><b>8.5.</b> Navigate from here</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.8.6">
            
            <span><b>8.6.</b> Occurrences</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.9" data-path="Features/OptionsPages.html">
            
                
                    <a href="../../Features/OptionsPages.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                         Options Pages
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.10">
            
            <span><b>10.</b> Tools</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.10.1" data-path="Features/Tools/CodeCleanup.html">
            
                
                    <a href="../../Features/Tools/CodeCleanup.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.1.</b>
                        
                         Code cleanup
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.10.2">
            
            <span><b>10.2.</b> Code structure</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.10.3">
            
            <span><b>10.3.</b> Todo items</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.10.4">
            
            <span><b>10.4.</b> Bookmarks</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.10.5">
            
            <span><b>10.5.</b> Assembly explorer</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.11">
            
            <span><b>11.</b> Naming</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.11.1">
            
            <span><b>11.1.</b> Suggestions</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.11.2">
            
            <span><b>11.2.</b> Policy</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.12">
            
            <span><b>12.</b> Editing</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.12.1">
            
            <span><b>12.1.</b> Formatting</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.12.2">
            
            <span><b>12.2.</b> Typing assist</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.12.3">
            
            <span><b>12.3.</b> Complete statement</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.12.4">
            
            <span><b>12.4.</b> Extend selection</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.12.5">
            
            <span><b>12.5.</b> Rearrange code</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.12.6">
            
            <span><b>12.6.</b> Comments</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.13">
            
            <span><b>13.</b> Structural Search and Replace</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.13.1">
            
            <span><b>13.1.</b> C# vs HTML and CSS</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.13.2">
            
            <span><b>13.2.</b> Progammatic usage</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.14" data-path="Features/LiveTemplates/Overview.html">
            
                
                    <a href="../../Features/LiveTemplates/Overview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>14.</b>
                        
                         Live Templates
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.14.1" data-path="Features/LiveTemplates/Macros.html">
            
                
                    <a href="../../Features/LiveTemplates/Macros.html">
                        <i class="fa fa-check"></i>
                        
                            <b>14.1.</b>
                        
                         Macros
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter active" data-level="6.14.2" data-path="Features/LiveTemplates/Scopes.html">
            
                
                    <a href="../../Features/LiveTemplates/Scopes.html">
                        <i class="fa fa-check"></i>
                        
                            <b>14.2.</b>
                        
                         Scopes
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.14.3">
            
            <span><b>14.3.</b> Categories</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.14.4">
            
            <span><b>14.4.</b> Quick lists</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.14.5">
            
            <span><b>14.5.</b> Hotspots</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.14.6">
            
            <span><b>14.6.</b> Programmatic usage</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.15" data-path="Features/UnitTest.html">
            
                
                    <a href="../../Features/UnitTest.html">
                        <i class="fa fa-check"></i>
                        
                            <b>15.</b>
                        
                         Unit Test
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.15.1">
            
            <span><b>15.1.</b> Test discovery</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.15.2">
            
            <span><b>15.2.</b> Test execution</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.15.3">
            
            <span><b>15.3.</b> Non-CLR tests</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.16">
            
            <span><b>16.</b> Diagramming</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.16.1">
            
            <span><b>16.1.</b> Architecture diagrams</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.17">
            
            <span><b>17.</b> External sources</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.17.1">
            
            <span><b>17.1.</b> PDB symbols</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.17.2">
            
            <span><b>17.2.</b> Decompiling</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.17.3">
            
            <span><b>17.3.</b> Source servers</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.18">
            
            <span><b>18.</b> Asp.net MVC</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.19">
            
            <span><b>19.</b> Internationalisation</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="6.20" data-path="Features/XmlLike.html">
            
                
                    <a href="../../Features/XmlLike.html">
                        <i class="fa fa-check"></i>
                        
                            <b>20.</b>
                        
                         Working with XML-like files
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="part" data-level="7">
            
            <span> Part VI - Product Specific</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="7.1" data-path="Products/dotPeek.html">
            
                
                    <a href="../../Products/dotPeek.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                         dotPeek
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.2" data-path="Products/InspectCode.html">
            
                
                    <a href="../../Products/InspectCode.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                         InspectCode
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="part" data-level="8">
            
            <span> Part VII - Custom languages</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.1" data-path="CustomLanguages/Overview.html">
            
                
                    <a href="../../CustomLanguages/Overview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                         Overview
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.2">
            
            <span><b>2.</b> Disabling language support</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="8.3">
            
            <span><b>3.</b> Project model language support</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="8.4">
            
            <span><b>4.</b> PSI language support</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5">
            
            <span><b>5.</b> Secondary PSI</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="8.6" data-path="CustomLanguages/InjectedPsi.html">
            
                
                    <a href="../../CustomLanguages/InjectedPsi.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                         Injected PSI
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.7">
            
            <span><b>7.</b> Lexing and parsing</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="8.8">
            
            <span><b>8.</b> psi files</span>
            
            
        </li>
    
        
        <li class="chapter " data-level="8.9">
            
            <span><b>9.</b> PsiGen</span>
            
            
        </li>
    

            </ul>
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Generated using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 91.04477611940298%;min-width: 89.55223880597015%;"></div>
    </div>
    <div class="chapters">
    
        <a href="../../index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="../../StyleGuide.html" title="Style guide" class="chapter done " data-progress="1.1" style="left: 1.492537313432836%;"></a>
    
        <a href="../../wip.html" title="Work in progress" class="chapter done " data-progress="1.2" style="left: 2.985074626865672%;"></a>
    
        <a href="../../Intro/Tools.html" title="Tools" class="chapter done " data-progress="2.1.1" style="left: 4.477611940298507%;"></a>
    
        <a href="../../Extensions/Packaging.html" title="Packaging and Distribution" class="chapter done " data-progress="2.2.5" style="left: 5.970149253731344%;"></a>
    
        <a href="../../HowDoI.html" title="How do I?" class="chapter done " data-progress="2.3" style="left: 7.462686567164179%;"></a>
    
        <a href="../../Plugins/SDK.html" title="SDK Reference" class="chapter done " data-progress="2.4.1" style="left: 8.955223880597014%;"></a>
    
        <a href="../../Plugins/ProjectSetup.html" title="Project Setup" class="chapter done " data-progress="2.4.2" style="left: 10.447761194029852%;"></a>
    
        <a href="../../Intro/KnownIssues.html" title="Known Issues" class="chapter done " data-progress="2.4.4" style="left: 11.940298507462687%;"></a>
    
        <a href="../../Plugins/Testing.html" title="Plugin testing" class="chapter done " data-progress="2.4.5" style="left: 13.432835820895523%;"></a>
    
        <a href="../../Plugins/TemporarySettings.html" title="Temporary Settings" class="chapter done " data-progress="2.4.5.2" style="left: 14.925373134328359%;"></a>
    
        <a href="../../Intro/Glossary.html" title="Glossary" class="chapter done " data-progress="2.5" style="left: 16.417910447761194%;"></a>
    
        <a href="../../Architecture/Overview.html" title="Overview" class="chapter done " data-progress="3.1" style="left: 17.91044776119403%;"></a>
    
        <a href="../../Platform/Lifetime.html" title="Lifetime" class="chapter done " data-progress="4.3" style="left: 19.402985074626866%;"></a>
    
        <a href="../../Platform/Lifetime/Usage.html" title="Usage" class="chapter done " data-progress="4.3.1" style="left: 20.895522388059703%;"></a>
    
        <a href="../../Platform/Lifetime/LifetimeDefinition.html" title="Lifetime Management" class="chapter done " data-progress="4.3.2" style="left: 22.388059701492537%;"></a>
    
        <a href="../../Platform/Lifetime/Advanced.html" title="Advanced Lifetime Management" class="chapter done " data-progress="4.3.3" style="left: 23.880597014925375%;"></a>
    
        <a href="../../Platform/Lifetime/ComponentModel.html" title="Component Lifetime" class="chapter done " data-progress="4.3.4" style="left: 25.37313432835821%;"></a>
    
        <a href="../../Platform/Lifetime/CaseStudy.html" title="Case Study" class="chapter done " data-progress="4.3.5" style="left: 26.865671641791046%;"></a>
    
        <a href="../../Platform/ComponentModel.html" title="Component Model" class="chapter done " data-progress="4.4" style="left: 28.35820895522388%;"></a>
    
        <a href="../../Platform/VisualStudio/ComponentModel.html" title="Visual Studio interfaces" class="chapter done " data-progress="4.4.1" style="left: 29.850746268656717%;"></a>
    
        <a href="../../Platform/TextControl.html" title="TextControl" class="chapter done " data-progress="4.6" style="left: 31.34328358208955%;"></a>
    
        <a href="../../Platform/VisualStudio/CustomHives.html" title="Experimental Instances" class="chapter done " data-progress="4.12.1.1" style="left: 32.83582089552239%;"></a>
    
        <a href="../../Platform/Shell/ToolWindows.html" title="Tool windows" class="chapter done " data-progress="4.12.3" style="left: 34.32835820895522%;"></a>
    
        <a href="../../Platform/Shell/Icons.html" title="Icons" class="chapter done " data-progress="4.12.4" style="left: 35.82089552238806%;"></a>
    
        <a href="../../Platform/Settings.html" title="Settings" class="chapter done " data-progress="4.14" style="left: 37.3134328358209%;"></a>
    
        <a href="../../PSI/NavigatingSyntaxTrees.html" title="Navigating syntax trees" class="chapter done " data-progress="5.2" style="left: 38.80597014925373%;"></a>
    
        <a href="../../PSI/SyntaxTrees/StronglyTypedNavigation.html" title="Strongly typed navigation" class="chapter done " data-progress="5.2.2" style="left: 40.298507462686565%;"></a>
    
        <a href="../../PSI/References/ReferenceProviders.html" title="Reference providers" class="chapter done " data-progress="5.4.2" style="left: 41.791044776119406%;"></a>
    
        <a href="../../PSI/References/CodeCompletion.html" title="Code Completion" class="chapter done " data-progress="5.4.3" style="left: 43.28358208955224%;"></a>
    
        <a href="../../PSI/References/Substrings.html" title="References within elements" class="chapter done " data-progress="5.4.4" style="left: 44.776119402985074%;"></a>
    
        <a href="../../PSI/References/IReferenceProvider.html" title="Managing reference providers" class="chapter done " data-progress="5.4.5" style="left: 46.26865671641791%;"></a>
    
        <a href="../../PSI/References/PathReferences.html" title="Path references" class="chapter done " data-progress="5.4.6" style="left: 47.76119402985075%;"></a>
    
        <a href="../../PSI/Generating/Code.html" title="Generating code" class="chapter done " data-progress="5.5" style="left: 49.25373134328358%;"></a>
    
        <a href="../../PSI/Generating/Comments.html" title="Generating comments" class="chapter done " data-progress="5.5.1" style="left: 50.74626865671642%;"></a>
    
        <a href="../../PSI/TypeSystem.html" title="Type system" class="chapter done " data-progress="5.6.1" style="left: 52.23880597014925%;"></a>
    
        <a href="../../PSI/Caches.html" title="Caches" class="chapter done " data-progress="5.8" style="left: 53.73134328358209%;"></a>
    
        <a href="../../PSI/ExternalAnnotations/Testing.html" title="Testing" class="chapter done " data-progress="5.9.1" style="left: 55.223880597014926%;"></a>
    
        <a href="../../PSI/Reference/Xml/Overview.html" title="XML and DTD" class="chapter done " data-progress="5.10.10" style="left: 56.71641791044776%;"></a>
    
        <a href="../../PSI/Reference/Xml/Navigators.html" title="Navigators" class="chapter done " data-progress="5.10.10.1" style="left: 58.208955223880594%;"></a>
    
        <a href="../../PSI/Reference/Xml/Utils.html" title="Utils" class="chapter done " data-progress="5.10.10.2" style="left: 59.701492537313435%;"></a>
    
        <a href="../../PSI/Reference/Xml/TreeNodes.html" title="Tree Nodes" class="chapter done " data-progress="5.10.10.3" style="left: 61.19402985074627%;"></a>
    
        <a href="../../PSI/Reference/Xml/TreeNodesDTD.html" title="Tree Nodes (DTD)" class="chapter done " data-progress="5.10.10.4" style="left: 62.6865671641791%;"></a>
    
        <a href="../../Features/Analysis/Daemons.html" title="Daemons" class="chapter done " data-progress="6.1.4" style="left: 64.17910447761194%;"></a>
    
        <a href="../../Features/Actions.html" title="Actions" class="chapter done " data-progress="6.2" style="left: 65.67164179104478%;"></a>
    
        <a href="../../Features/Actions/QuickFixes.html" title="Quick fixes" class="chapter done " data-progress="6.2.2" style="left: 67.16417910447761%;"></a>
    
        <a href="../../Features/Actions/Bulk.html" title="Bulk actions" class="chapter done " data-progress="6.2.4" style="left: 68.65671641791045%;"></a>
    
        <a href="../../Features/Completion.html" title="Code Completion" class="chapter done " data-progress="6.3" style="left: 70.14925373134328%;"></a>
    
        <a href="../../Features/QuickDoc/Overview.html" title="Quick Doc" class="chapter done " data-progress="6.5.1" style="left: 71.64179104477611%;"></a>
    
        <a href="../../Features/QuickDoc/ImplementingProvider.html" title="IQuickDocProvider" class="chapter done " data-progress="6.5.1.1" style="left: 73.13432835820896%;"></a>
    
        <a href="../../Features/QuickDoc/ImplementingPresenter.html" title="IQuickDocPresenter" class="chapter done " data-progress="6.5.1.2" style="left: 74.6268656716418%;"></a>
    
        <a href="../../Features/QuickDoc/HelperClasses.html" title="Helper classes" class="chapter done " data-progress="6.5.1.3" style="left: 76.11940298507463%;"></a>
    
        <a href="../../Features/QuickDoc/ExistingProviders.html" title="Existing providers" class="chapter done " data-progress="6.5.1.4" style="left: 77.61194029850746%;"></a>
    
        <a href="../../Features/QuickDoc/Testing.html" title="Testing" class="chapter done " data-progress="6.5.1.5" style="left: 79.1044776119403%;"></a>
    
        <a href="../../Features/Refactoring.html" title="Refactoring" class="chapter done " data-progress="6.6" style="left: 80.59701492537313%;"></a>
    
        <a href="../../Features/GenerateMenu.html" title="Generate Menu" class="chapter done " data-progress="6.7" style="left: 82.08955223880596%;"></a>
    
        <a href="../../Features/Navigation.html" title="Navigation" class="chapter done " data-progress="6.8" style="left: 83.58208955223881%;"></a>
    
        <a href="../../Features/OptionsPages.html" title="Options Pages" class="chapter done " data-progress="6.9" style="left: 85.07462686567165%;"></a>
    
        <a href="../../Features/Tools/CodeCleanup.html" title="Code cleanup" class="chapter done " data-progress="6.10.1" style="left: 86.56716417910448%;"></a>
    
        <a href="../../Features/LiveTemplates/Overview.html" title="Live Templates" class="chapter done " data-progress="6.14" style="left: 88.05970149253731%;"></a>
    
        <a href="../../Features/LiveTemplates/Macros.html" title="Macros" class="chapter done " data-progress="6.14.1" style="left: 89.55223880597015%;"></a>
    
        <a href="../../Features/LiveTemplates/Scopes.html" title="Scopes" class="chapter done " data-progress="6.14.2" style="left: 91.04477611940298%;"></a>
    
        <a href="../../Features/UnitTest.html" title="Unit Test" class="chapter  " data-progress="6.15" style="left: 92.53731343283582%;"></a>
    
        <a href="../../Features/XmlLike.html" title="Working with XML-like files" class="chapter  " data-progress="6.20" style="left: 94.02985074626865%;"></a>
    
        <a href="../../Products/dotPeek.html" title="dotPeek" class="chapter  " data-progress="7.1" style="left: 95.5223880597015%;"></a>
    
        <a href="../../Products/InspectCode.html" title="InspectCode" class="chapter  " data-progress="7.2" style="left: 97.01492537313433%;"></a>
    
        <a href="../../CustomLanguages/Overview.html" title="Overview" class="chapter  " data-progress="8.1" style="left: 98.50746268656717%;"></a>
    
        <a href="../../CustomLanguages/InjectedPsi.html" title="Injected PSI" class="chapter  " data-progress="8.6" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_14">
                    
                        <h1 id="scopes"><a name="scopes" class="plugin-anchor" href="#scopes"><span class="fa fa-link"></span></a>Scopes</h1>
<p>ReSharper&apos;s Live Templates can declare the <em>scope</em> in which they are available. That is, instead of allowing all templates to be inserted at any location in any file, a template can be constrained to certain file types, and even to certain locations within those files. For example, a template can be constrained not just to C# files, but to any location where a namespace declaration, type definition, or an expression is valid.</p>
<p>Furthermore, the template scope can be parameterised. For example, a C# template can state that it is only available in C# 3.0 files (perhaps the template wants to make use of LINQ), or in files that match a specific file pattern (e.g. &quot;actions.xml&quot;, &quot;*.html&quot;, etc.)</p>
<p>A template can have multiple scope points, in which case, the template is available if any of the scope points match the current context.</p>
<!-- TODO: Add image for the scope UI -->
<p>In this way, templates can be constrained to be more targeted and useful, even allowing multiple templates with the same shortcut, as long as they are valid in different scopes.</p>
<h2 id="implementing-a-custom-scope-provider"><a name="implementing-a-custom-scope-provider" class="plugin-anchor" href="#implementing-a-custom-scope-provider"><span class="fa fa-link"></span></a>Implementing a custom scope provider</h2>
<p>The <code>TemplateScopeManager</code> shell component is the main entry point for working with scope points, and it maintains a list of <code>IScopeProvider</code> shell components. As such, it can be extended by a class implementing <code>IScopeProvider</code> and decorated with the <code>[ShellComponent]</code> attribute.</p>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-4x fa-edit"></strong>
<p> The list of <code>IScopeProvider</code> components maintained by the <code>TemplateScopeManager</code> is injected as an <code>IEnumerable&lt;IScopeProvider&gt;</code> rather than an <code>IViewable&lt;IScopeProvider&gt;</code>. Therefore, the list does not update when new components are made available. Live loading of plugins is not supported; when a new plugin is installed, ReSharper must be restarted before the new scope provider is used.</p>
</blockquote>
<p>The <code>IScopeProvider</code> interface declares three methods that are used to create scope points:</p>
<pre><code class="lang-cs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> IScopeProvider
{
  IEnumerable&lt;ITemplateScopePoint&gt; ProvideScopePoints(TemplateAcceptanceContext context);
  ITemplateScopePoint ReadFromXml([NotNull] XmlElement scopeElement);
  ITemplateScopePoint CreateScope(Guid scopeGuid, <span class="hljs-keyword">string</span> typeName, IEnumerable&lt;Pair&lt;<span class="hljs-keyword">string</span>, <span class="hljs-keyword">string</span>&gt;&gt; customProperties);
}
</code></pre>
<ul>
<li><strong><code>ProvideScopePoints</code></strong> - returns all scope points that are valid at the context described by the given <code>TemplateAcceptanceContext</code> instance, which provides details about file and text caret position. Parameterised scope points are either set to a reasonable value (for example, C# scope points can set a language version of 3.0 when the current context is in a LINQ query), or replaced by a scope point that makes more sense for the current context (instead of creating a file mask scope point of &quot;*.*&quot;, a project file scope point is returned. This scope point knows how to compare itself against a file mask scope point used in a template)</li>
<li><p><strong><code>ReadFromXml</code></strong> - used to read a scope point from an XML file. This is not typically used any more, as recent versions of ReSharper store and export templates in <code>.dotSettings</code> format, rather than the proprietary XML read by this method. However, the built-in providers still support this, in order to upgrade existing files in the old format. The complement to this method is the <code>ITemplateScopePoint.WriteToXml</code> method, which is still supported, but no longer exposed by ReSharper.</p>
<p>  The <code>ScopeProvider</code> abstract base class used by all of the built-in providers will create a new instance based on the short type name in the <code>type</code> attribute of the XML element. Deriving classes should call the base method to create the instance, then populate it based on other attributes or child elements of the given XML element.</p>
</li>
<li><p><strong><code>CreateScope</code></strong> should create an instance of <code>ITemplateScopePoint</code> based on the given short type name. It receives a GUID identifier that is unique for each template scope point instance (remember, scope points might be parameterised) and custom properties as string name/value pairs. This method is used to read the scope point from a <code>.dotSettings</code> file, which stores all information as name/value pairs.</p>
<p>  Again, the <code>ScopeProvider</code> abstract base class will create a new instance based on the given type name and populate the <code>ITemplateScopePoint.UID</code> with the unique ID. Derived classes should call the base class and populate the new instance based on the custom properties.</p>
</li>
</ul>
<p>The <code>ScopeProvider</code> abstract base class provides a mechanism for creating specific instances of <code>ITemplateScopePoint</code> based on a given type name. While it can simply instantiate the type based on the type name, it defers to a list of creator functions that take in the type name and create the scope point instance. This provides an extension point for custom creation, while also making it easy to create simple instances.</p>
<p>For example, the CSS scope provider will set up a list of creator functions that simply defer to <code>ScopeProvider.TryToCreate&lt;T&gt;</code> which will create the type if the type name matches:</p>
<pre><code class="lang-cs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> CssScopeProvider : ScopeProvider
{
  <span class="hljs-keyword">public</span> <span class="hljs-title">CssScopeProvider</span>()
  {
    Creators.AddRange(<span class="hljs-keyword">new</span> List&lt;Func&lt;<span class="hljs-keyword">string</span>, ITemplateScopePoint&gt;&gt;
    {
      s =&gt; TryToCreate&lt;InCssFile&gt;(s),
      s =&gt; TryToCreate&lt;InCssExpression&gt;(s),
      s =&gt; TryToCreate&lt;InCssStatement&gt;(s),
    });
  }

  <span class="hljs-comment">// ...</span>
}
</code></pre>
<h3 id="example-iscopeproviderprovidescopepoints-implementation"><a name="example-iscopeproviderprovidescopepoints-implementation" class="plugin-anchor" href="#example-iscopeproviderprovidescopepoints-implementation"><span class="fa fa-link"></span></a>Example IScopeProvider.ProvideScopePoints implementation</h3>
<p>The following is an example of an implementation of <code>IScopeProvider.ProvideScopePoints</code> for CSS files. It examines the current context, as provided by <code>TemplateAcceptanceContext</code> and returns scope points that are valid:</p>
<pre><code class="lang-cs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> IEnumerable&lt;ITemplateScopePoint&gt; <span class="hljs-title">ProvideScopePoints</span>(TemplateAcceptanceContext context)
{
  <span class="hljs-comment">// Ensure we have an IPsiSourceFile, a valid document range, and the file is a CSS file</span>
  <span class="hljs-keyword">if</span> (context.SourceFile == <span class="hljs-keyword">null</span>)
    <span class="hljs-keyword">yield</span> <span class="hljs-keyword">break</span>;

  <span class="hljs-keyword">var</span> documentRange = <span class="hljs-keyword">new</span> DocumentRange(context.Document, context.CaretOffset);
  <span class="hljs-keyword">if</span> (!documentRange.IsValid())
    <span class="hljs-keyword">yield</span> <span class="hljs-keyword">break</span>;

  <span class="hljs-keyword">var</span> file = context.SourceFile.GetPsiFile&lt;CssLanguage&gt;(documentRange);
  <span class="hljs-keyword">if</span> (file == <span class="hljs-keyword">null</span>)
    <span class="hljs-keyword">yield</span> <span class="hljs-keyword">break</span>;

  <span class="hljs-comment">// Get the prefix at the text caret. This is treated as the shortcut that invokes the template</span>
  <span class="hljs-comment">// Then get the AST element that represents the prefix</span>
  <span class="hljs-keyword">var</span> prefix = LiveTemplatesManager.GetPrefix(context.Document, context.CaretOffset);
  <span class="hljs-keyword">var</span> element = file.FindTokenAt(context.Document, context.CaretOffset - prefix.Length) <span class="hljs-keyword">as</span> ITokenNode;

  <span class="hljs-keyword">if</span> (element == <span class="hljs-keyword">null</span> &amp;&amp; String.IsNullOrEmpty(prefix))
  {
    <span class="hljs-keyword">if</span> (context.Document.GetTextLength() == <span class="hljs-number">0</span>)
    {
      <span class="hljs-comment">// There is no element at the caret, no known prefix and the document is empty</span>
      <span class="hljs-comment">// Valid scope points are anywhere in a CSS file, and anywhere a CSS statement is valid</span>
      <span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> InCssFile();
      <span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> InCssStatement();
      <span class="hljs-keyword">yield</span> <span class="hljs-keyword">break</span>;
    }

    <span class="hljs-comment">// If the caret is at the end of the file, get the token just before the EOF</span>
    <span class="hljs-keyword">if</span> (context.Document.GetTextLength() == context.CaretOffset)
      element = file.FindTokenAt(context.Document, context.CaretOffset - <span class="hljs-number">1</span>) <span class="hljs-keyword">as</span> ITokenNode;
  }

  <span class="hljs-comment">// There is no token, so no valid scope points</span>
  <span class="hljs-keyword">if</span>(element == <span class="hljs-keyword">null</span>)
    <span class="hljs-keyword">yield</span> <span class="hljs-keyword">break</span>;

  <span class="hljs-keyword">var</span> treeOffset = file.Translate(context.Document, context.CaretOffset);
  <span class="hljs-keyword">if</span> (!treeOffset.IsValid())
    <span class="hljs-keyword">yield</span> <span class="hljs-keyword">break</span>;

  <span class="hljs-comment">// Return a valid CSS file scope point</span>
  <span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> InCssFile();

  <span class="hljs-comment">// Look at the containing node, and return either a CSS expression or CSS statement scope point</span>
  <span class="hljs-keyword">if</span> (element.GetContainingNode&lt;ICssPropertyValue&gt;(<span class="hljs-keyword">true</span>) != <span class="hljs-keyword">null</span> || element.GetContainingNode&lt;ICssExpression&gt;(<span class="hljs-keyword">true</span>) != <span class="hljs-keyword">null</span>)
    <span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> InCssExpression();
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (element.GetContainingNode&lt;ICssPropertyStatement&gt;(<span class="hljs-keyword">true</span>).IfNotNull(s =&gt; s.Property.IfNotNull(p =&gt; p.ColonToken.IfNotNull(n =&gt; n.GetTreeStartOffset() &lt; element.GetTreeStartOffset()))))
    <span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> InCssExpression();
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (element.GetContainingNode&lt;IMediaFeature&gt;(<span class="hljs-keyword">true</span>).IfNotNull(f =&gt; f.ColonToken.IfNotNull(n =&gt; n.GetTreeStartOffset() &lt; element.GetTreeStartOffset())) )
    <span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> InCssExpression();
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(element.GetContainingNode&lt;ICssPropertyStatement&gt;(<span class="hljs-keyword">true</span>) == <span class="hljs-keyword">null</span> &amp;&amp; element.GetContainingNode&lt;IMediaFeature&gt;(<span class="hljs-keyword">true</span>) == <span class="hljs-keyword">null</span>)
  {
    <span class="hljs-keyword">if</span> (element.GetContainingNode&lt;ICssBlock&gt;() != <span class="hljs-keyword">null</span> || element.GetContainingNode&lt;IMediaQueryList&gt;() != <span class="hljs-keyword">null</span>)
      <span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> InCssStatement();
  }
}
</code></pre>
<p>The call to <code>LiveTemplatesManager.GetPrefix</code> gets the &quot;word&quot; that precedes the current text caret position. It is used here to find the position in the document that marks the start of the context of the scope point. This position is used to retrieve the node from the abstract syntax tree, which can then be used to see if the scope point is inside an expression or a statement, or so on.</p>
<p>A &quot;word&quot; is defined as any character preceding the current text caret that is a letter or digit, or is one of a set of allowed characters. The overload shown above does not specify any additional characters, so uses the default of the underscore character <code>&apos;_&apos;</code>. Another overload takes an array of allowed chars.</p>
<pre><code class="lang-cs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">string</span> <span class="hljs-title">GetPrefix</span>(IDocument document, <span class="hljs-keyword">int</span> caretOffset, <span class="hljs-keyword">params</span> <span class="hljs-keyword">char</span>[] allowedChars)
</code></pre>
<p>For example, the <code>HTMLScopeProvider</code> class calls <code>GetPrefix</code> with an array of <code>{ &apos;_&apos; }</code> when fetching the prefix for file scope, and uses <code>{ &apos;_&apos;, &apos;&lt;&apos;, &apos;:&apos; }</code> when fetching the prefix for tag scope.</p>
<h2 id="implementing-a-custom-scope-point"><a name="implementing-a-custom-scope-point" class="plugin-anchor" href="#implementing-a-custom-scope-point"><span class="fa fa-link"></span></a>Implementing a custom scope point</h2>
<p>A scope point is implemented by deriving from <code>ITemplateScopePoint</code>, and is usually implemented by deriving from the <code>TemplateScopePoint</code> abstract base class. It is not a component from the Component Model, but just a class created by an <code>IScopeProvider</code>. The interface is:</p>
<pre><code class="lang-cs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> ITemplateScopePoint
{
  <span class="hljs-keyword">bool</span> IsSubsetOf(ITemplateScopePoint other);
  <span class="hljs-keyword">string</span> Prefix { <span class="hljs-keyword">get</span>; }
  <span class="hljs-keyword">string</span> CalcPrefix(IDocument document, <span class="hljs-keyword">int</span> caretOffset);
  [NotNull] XmlElement WriteToXml(XmlElement element);
  <span class="hljs-keyword">string</span> PresentableShortName { <span class="hljs-keyword">get</span>; }
  PsiLanguageType RelatedLanguage { <span class="hljs-keyword">get</span>; }
  Guid UID { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
  Guid GetDefaultUID();
  <span class="hljs-keyword">string</span> GetTagName();
  IEnumerable&lt;Pair&lt;<span class="hljs-keyword">string</span>, <span class="hljs-keyword">string</span>&gt;&gt;  EnumerateCustomProperties();
}
</code></pre>
<ul>
<li><strong><code>IsSubsetOf</code></strong></li>
<li><strong><code>Prefix</code></strong></li>
<li><strong><code>CalcPrefix</code></strong></li>
<li><strong><code>WriteToXml</code></strong> - used to write the scope point, including parameters, to XML. This is the complement to <code>IScopeProvider.ReadFromXml</code>. ReSharper no longer uses this method for saving scope points, as templates are now saved in <code>.dotSettings</code> format.</li>
<li><strong><code>PresentableShortName</code></strong> - a short description of the scope point, displayed in the template editor UI. Can be a static string, or reflecting the parameters, such as <code>&quot;&apos;*.*; *.html&apos; files&quot;</code>.</li>
<li><strong><code>RelatedLanguage</code></strong> - returns the <code>PsiLanguageType</code> that applies to this scope point. If the scope point is language agnostic, the default implementation from <code>TemplateScopePoint.RelatedLanguage</code> will return <code>null</code>.</li>
<li><strong><code>UID</code></strong> - a property containing the unique ID for this instance of the scope point. Automatically set when creating the scope via <code>IScopeProvider.CreateScope</code>.</li>
<li><strong><code>GetDefaultUID</code></strong></li>
<li><strong><code>GetTagName</code></strong> - returns the short type name, saved to the <code>.dotSettings</code> file, and used to pass to <code>IScopeProvider.CreateScope</code>. The default implementation in the <code>TemplateScopePoint</code> returns the short type name.</li>
<li><strong><code>EnumerateCustomProperties</code></strong> - returns a set of name/value string pairs listing the custom properties of the scope point. Used to save the properties to the <code>.dotSettings</code> file format. The <code>TemplateScopePoint</code> abstract base class returns an empty enumeration.</li>
</ul>
<p><code>IMainScopePoint</code> used by QuickListSupport, IScopeCategoryUIProvider and SupportedQuickList</p>

                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="../../Features/LiveTemplates/Macros.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: Macros"><i class="fa fa-angle-left"></i></a>
        
        
    </div>
</div>

        
<script src="../../gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
<script src="../../gitbook/app.js"></script>

<script>
require(["gitbook"], function(gitbook) {
    var config = {};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
